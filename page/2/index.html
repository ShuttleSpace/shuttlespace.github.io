<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#025a6c">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#025a6c">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.dang8080.cn","root":"/","scheme":"Gemini","version":"7.7.1","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#025a6c","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":true,"preload":true},"motion":{"enable":false,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="write something,donot leave.">
<meta property="og:type" content="website">
<meta property="og:title" content="äº‘é’é’å…®æ¬²é›¨">
<meta property="og:url" content="http://blog.dang8080.cn/page/2/index.html">
<meta property="og:site_name" content="äº‘é’é’å…®æ¬²é›¨">
<meta property="og:description" content="write something,donot leave.">
<meta property="article:author" content="Humphrey Dan">
<meta property="article:tag" content="Android">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="Kotlin">
<meta property="article:tag" content="JS">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://blog.dang8080.cn/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>äº‘é’é’å…®æ¬²é›¨</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">äº‘é’é’å…®æ¬²é›¨</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">æ°´æ¾¹æ¾¹å…®ç”ŸçƒŸ</p>
  </div>

  <div class="site-nav-right"></div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-daily">

    <a href="/daily/" rel="section"><i class="fa fa-fw fa-calendar"></i>daily</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.dang8080.cn/2019/06/05/Flutter-Image/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Humphrey Dan">
      <meta itemprop="description" content="write something,donot leave.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="äº‘é’é’å…®æ¬²é›¨">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/06/05/Flutter-Image/" class="post-title-link" itemprop="url">Flutter-Image</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-06-05 13:04:47" itemprop="dateCreated datePublished" datetime="2019-06-05T13:04:47+08:00">2019-06-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-06-06 12:58:37" itemprop="dateModified" datetime="2019-06-06T12:58:37+08:00">2019-06-06</time>
              </span>

          
            <span id="/2019/06/05/Flutter-Image/" class="post-meta-item leancloud_visitors" data-flag-title="Flutter-Image" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2019/06/05/Flutter-Image/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/06/05/Flutter-Image/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æ˜¾ç¤ºå›¾ç‰‡çš„ç»„ä»¶.</p>
<p>æä¾›äº†ä»¥ä¸‹å‡ ä¸ªä¸åŒç”¨é€”çš„æ„é€ æ–¹æ³•:</p>
<ul>
<li><code>new Image</code>: ä» <code>ImageProvider</code> ä¸­è·å–å›¾ç‰‡.</li>
<li><code>new Image.asset</code>: ä½¿ç”¨ key ä» <code>AssetBundle</code> ä¸­è·å–å›¾ç‰‡</li>
<li><code>new Image.network</code>: ä» URL ä¸­è·å–å›¾ç‰‡</li>
<li><code>new Image.file</code>: ä» <code>File</code> ä¸­è·å–å›¾ç‰‡</li>
<li><code>new Image.memory</code>: ä» <code>Uint8List</code> ä¸­è·å–å›¾ç‰‡</li>
</ul>
<p>æ”¯æŒä»¥ä¸‹å›¾ç‰‡æ ¼å¼: JPEG,PNG,GIF,Animated GIF,WebP,Animated WebP,BMP,WBMP.</p>
<p>ä¸ºäº†è‡ªåŠ¨å®ç°åƒç´ å¯†åº¦çº§çš„èµ„äº§ç®¡ç†, ç¡®ä¿åœ¨ <code>MaterialApp</code>,<code>WidgetsApp</code>,<code>MediaQuery</code>ç»„ä»¶æ ‘ä¸­ä½¿ç”¨ <code>AssetImage</code> æŒ‡å®šçš„ <code>Image</code> ç»„ä»¶.</p>
<p>å›¾ç‰‡æ˜¯ç”¨ <code>paintImage</code> ç”»å‡ºæ¥çš„,å®ƒåŒ…å«äº† Image ä¸­çš„ä¸åŒå±æ€§è¯¦æƒ…æè¿°.</p>
<h2 id="ç±»ä¼¼ç»„ä»¶"><a href="#ç±»ä¼¼ç»„ä»¶" class="headerlink" title="ç±»ä¼¼ç»„ä»¶"></a>ç±»ä¼¼ç»„ä»¶</h2><ul>
<li><code>Icon</code></li>
<li><code>new Ink.Image</code>: åœ¨ material app ä¸­æ¨èä½¿ç”¨(ç‰¹åˆ«æ˜¯å›¾ç‰‡åœ¨ <code>Material</code> ä¸­,è€Œä¸”ä¸Šé¢æœ‰ <code>InkWell</code>)</li>
<li><code>Image</code>: <code>dart:ui</code> æä¾›</li>
</ul>
<h2 id="ç»§æ‰¿-ğŸŒ²"><a href="#ç»§æ‰¿-ğŸŒ²" class="headerlink" title="ç»§æ‰¿ ğŸŒ²"></a>ç»§æ‰¿ ğŸŒ²</h2><p><code>Object &gt; Diagnosticable &gt; DiagnosticableTree &gt; Widget &gt; StatefulWidget &gt; Image</code></p>
<h2 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h2><ul>
<li><code>alignment</code> -&gt; <code>AlignmentGeometry</code></li>
<li><code>centerSlice</code> -&gt; <code>Rect</code>: .9 å›¾</li>
<li><code>color</code> -&gt; <code>Color</code></li>
<li><code>colorBlendMode</code> -&gt; <code>BlendMode</code>: æ··åˆé¢œè‰²</li>
<li><code>excludeFromSemantics</code> -&gt; <code>bool</code></li>
<li><code>filterQuality</code> -&gt; <code>FilterQuality</code></li>
<li><code>fit</code> -&gt; <code>BoxFit</code></li>
<li><code>gaplessPlayback</code> -&gt; <code>bool</code>: å½“ image provider æ”¹å˜æ—¶æ˜¯å¦æ˜¾ç¤ºæ—§çš„å›¾ç‰‡.</li>
<li><code>heihgt</code> -&gt; <code>double</code></li>
<li><code>image</code> -&gt; <code>ImageProvider</code></li>
<li><code>matchTextDirection</code> -&gt; <code>bool</code></li>
<li><code>repeat</code> -&gt; <code>ImageRepeat</code></li>
<li><code>semanticLabel</code> -&gt; <code>String</code></li>
<li><code>width</code> -&gt; <code>double</code></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.dang8080.cn/2019/06/04/Flutter-Column/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Humphrey Dan">
      <meta itemprop="description" content="write something,donot leave.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="äº‘é’é’å…®æ¬²é›¨">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/06/04/Flutter-Column/" class="post-title-link" itemprop="url">Flutter-Column</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-06-04 23:25:10" itemprop="dateCreated datePublished" datetime="2019-06-04T23:25:10+08:00">2019-06-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-06-05 13:03:37" itemprop="dateModified" datetime="2019-06-05T13:03:37+08:00">2019-06-05</time>
              </span>

          
            <span id="/2019/06/04/Flutter-Column/" class="post-meta-item leancloud_visitors" data-flag-title="Flutter-Column" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2019/06/04/Flutter-Column/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/06/04/Flutter-Column/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ä»¥å‚ç›´æ•°ç»„æ–¹å¼æ˜¾ç¤ºå­ç»„ä»¶çš„ç»„ä»¶.</p>
<p>æƒ³è¦æŸä¸ªå­ç»„ä»¶æ‰©å±•å¡«å……å‚ç›´ç©ºé—´,ä½¿ç”¨ <code>Expanded</code> ç»„ä»¶åŒ…è£…å³å¯.</p>
<p><code>Column</code> ç»„ä»¶ä¸ä¼šæ»‘åŠ¨(é€šå¸¸å¦‚æœ <code>Column</code> ä¸­çš„å¤šä¸ªå­ç»„ä»¶è¶…å‡ºäº†å¯ç”¨ç©ºé—´,åˆ™ä¼šæŠ¥é”™).å¦‚æœæœ‰ä¸€æ’ç»„ä»¶,è€Œä¸”æƒ³è¦åœ¨ç©ºé—´ä¸è¶³æ—¶èƒ½æ»‘åŠ¨,è€ƒè™‘ä½¿ç”¨ <code>ListView</code>.</p>
<p>æ¨ªå‘æ’åˆ—è€ƒè™‘ä½¿ç”¨ <code>Row</code>.</p>
<p>å¦‚æœåªæœ‰ä¸€ä¸ªå­ç»„ä»¶,è€ƒè™‘ä½¿ç”¨ <code>Align</code> æˆ– <code>Center</code> å®šä½ç»„ä»¶.</p>
<h4 id="å¦‚æœä¼ å…¥çš„å‚ç›´çº¦æŸæ˜¯æ— è¾¹ç•Œçš„"><a href="#å¦‚æœä¼ å…¥çš„å‚ç›´çº¦æŸæ˜¯æ— è¾¹ç•Œçš„" class="headerlink" title="å¦‚æœä¼ å…¥çš„å‚ç›´çº¦æŸæ˜¯æ— è¾¹ç•Œçš„"></a>å¦‚æœä¼ å…¥çš„å‚ç›´çº¦æŸæ˜¯æ— è¾¹ç•Œçš„</h4><p>å¦‚æœä¸€ä¸ª <code>Column</code> ç»„ä»¶æœ‰ä¸€ä¸ªæˆ–å¤šä¸ª <code>Expanded</code> æˆ– <code>Flexible</code> ç»„ä»¶,å¹¶ä¸”è¢«æ”¾åœ¨å¦ä¸€ä¸ª <code>Column</code> æˆ– <code>ListView</code> æˆ–å…¶ä»–ä¸æä¾›æœ€å¤§é«˜åº¦çº¦æŸä¸Šä¸‹æ–‡çš„ç»„ä»¶ä¸­,é‚£ä¹ˆå°†ä¼šæ”¶åˆ°ä¸€ä¸ªè¿è¡Œæ—¶å¼‚å¸¸,è¡¨æ˜æœ‰é 0 flex çš„å­ç»„ä»¶,ä½†æ˜¯å…¶å‚ç›´çº¦æŸæ˜¯æ— è¾¹ç•Œçš„.</p>
<p>æ­£å¦‚å¼‚å¸¸è¡¨ç°å‡ºæ¥çš„é—®é¢˜,ä½¿ç”¨ <code>Flexible</code> æˆ– <code>Expanded</code> æ„å‘³ç€æ¥ä¸‹æ¥å¸ƒå±€å…¶ä»–çš„å­ç»„ä»¶æ—¶å¿…é¡»æŠŠå‰©ä½™çš„ç©ºé—´å¹³å‡åˆ†é…,è€Œå¦‚æœä¼ å…¥çš„å‚ç›´çº¦æŸæ˜¯æ— è¾¹ç•Œçš„è¯,å‰©ä½™çš„ç©ºé—´å°±å˜æˆæ— é™çš„.</p>
<p>è§£å†³è¯¥é—®é¢˜çš„å…³é”®åœ¨äºä¸ºä»€ä¹ˆ <code>Column</code> ä¼šæ¥æ”¶åˆ°æ— è¾¹ç•Œçš„å‚ç›´çº¦æŸ.</p>
<p>ä¸€ä¸ªå¯èƒ½çš„åŸå› æ˜¯ <code>Column</code> è¢«æ”¾åœ¨äº†å¦ä¸€ä¸ª <code>Column</code> (å†…éƒ¨çš„ <code>Column</code> æ²¡æœ‰ä½¿ç”¨ <code>Expanded</code> æˆ– <code>Flexible</code> åŒ…è£…)ä¸­.å½“ä¸€ä¸ª <code>Column</code> å¸ƒå±€å®ƒçš„é flex å­ç»„ä»¶(æ²¡æœ‰ä½¿ç”¨ <code>Expanded</code> æˆ– <code>Flexible</code> åŒ…è£…)æ—¶,è¯¥ <code>Column</code> å°±ç»™äº†å…¶å­ç»„ä»¶æ— è¾¹ç•Œçš„çº¦æŸ,è¿™æ ·å­ç»„ä»¶å¯ä»¥è‡ªå·±å†³å®šä»–ä»¬çš„ç»´åº¦(ä¼ é€’æ— è¾¹ç•Œçš„çº¦æŸæ„å‘³ç€è¯¥å­ç»„ä»¶å¯èƒ½éœ€è¦æ”¶ç¼©ä»¥åŒ…è£…å…¶å†…å®¹).å¯¹åº”çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ <code>Expanded</code> åŒ…è£…å†…éƒ¨çš„ <code>Column</code>,è¡¨æ˜å†…éƒ¨çš„ <code>Column</code> åº”è¯¥å¡«å……å¤–éƒ¨ <code>Column</code> çš„å‰©ä½™ç©ºé—´,è€Œä¸æ˜¯å»è·å–å®ƒæƒ³è¦çš„ç©ºé—´å¤§å°.</p>
<p>å¦ä¸€ä¸ªå¯èƒ½çš„åŸå› æ˜¯ä¸€ä¸ª <code>Column</code> å¯èƒ½åµŒå¥—åœ¨ <code>ListView</code> æˆ–å…¶ä»–å¯æ»‘åŠ¨çš„å‚ç›´å¸ƒå±€ç»„ä»¶ä¸­.åœ¨è¿™ç§åœºæ™¯ä¸‹,ç¡®å®å­˜åœ¨æ— é™çš„å‚ç›´ç©ºé—´(å‚ç›´æ»‘åŠ¨åˆ—è¡¨çš„é‡ç‚¹åœ¨äºå…è®¸æ— é™å‚ç›´æ»‘åŠ¨).é€šå¸¸åº”è¯¥æ£€æŸ¥ä¸ºä»€ä¹ˆå†…éƒ¨çš„ <code>Column</code> ä¼šæœ‰ä¸€ä¸ª <code>Expanded</code> æˆ– <code>Flexible</code> å­ç»„ä»¶:å®ƒçš„å¤§å°çœŸçš„æ˜¯å†…éƒ¨å­ç»„ä»¶çš„å¤§å°å—?è§£å†³æ–¹æ¡ˆæ˜¯ä»åŒ…è£…å†…éƒ¨å­ç»„ä»¶çš„çˆ¶ç»„ä»¶ä¸­ç§»é™¤ <code>Expanded</code> æˆ– <code>Flexible</code> ç»„ä»¶.</p>
<p>æŸ¥çœ‹ <code>BoxConstraints</code> è·å–æ›´å¤šå…³äºçº¦æŸçš„ä¿¡æ¯.</p>
<h4 id="é»„é»‘ç›¸é—´æ¡"><a href="#é»„é»‘ç›¸é—´æ¡" class="headerlink" title="é»„é»‘ç›¸é—´æ¡"></a>é»„é»‘ç›¸é—´æ¡</h4><p>å½“ä¸€ä¸ª <code>Column</code> çš„å†…å®¹è¶…è¿‡äº†å¯ç”¨ç©ºé—´,å³ <code>Column</code> æº¢å‡º,é‚£ä¹ˆå†…å®¹å°†è¢«è£å‰ª.åœ¨ debug æ¨¡å¼ä¸‹,åœ¨æº¢å‡ºè¾¹è§’ä¸Šä¼šæ˜¾ç¤ºä¸€ä¸ªé»„é»‘ç›¸é—´æ¡æŒ‡å‡ºè¯¥é—®é¢˜,åœ¨ <code>Column</code> ä¸‹ä¼šæ‰“å°ä¸€ä¸ªæº¢å‡ºå¤šå°‘çš„ä¿¡æ¯.</p>
<p>æœ€æ™®éçš„è§£å†³æ–¹æ¡ˆæ˜¯å½“å‚ç›´ç©ºé—´å—é™æ—¶ç¡®ä¿å†…å®¹æ»‘åŠ¨ä½¿ç”¨ <code>ListView</code> è€Œä¸æ˜¯ <code>Column</code>.</p>
<h2 id="å¸ƒå±€ç®—æ³•"><a href="#å¸ƒå±€ç®—æ³•" class="headerlink" title="å¸ƒå±€ç®—æ³•"></a>å¸ƒå±€ç®—æ³•</h2><blockquote>
<p>æ¥ä¸‹æ¥æ˜¯ framework å¦‚ä½•æ¸²æŸ“ <code>Column</code>,æŸ¥çœ‹ <code>BoxConstraints</code> è·å–ç›’å¸ƒå±€æ¨¡å‹ä¿¡æ¯.</p>
</blockquote>
<p>å¸ƒå±€ <code>Column</code> éœ€è¦ 6 æ­¥.<br>1ã€ä½¿ç”¨æ— è¾¹ç•Œçš„æ°´å¹³çº¦æŸå’Œä¼ å…¥çš„å‚ç›´çº¦æŸè®¾ç½®æ¯ä¸ªå­ç»„ä»¶ flex å› å­ä¸º null æˆ– 0.å¦‚æœ <code>crossAxisAlignment</code> å€¼ä¸º <code>CrossAxisAlignment.stetch</code>,ä½¿ç”¨æ»¡è¶³ä¼ å…¥çš„å‚ç›´çº¦æŸçš„æœ€å¤§é«˜åº¦è€Œä¸æ˜¯ä½¿ç”¨å‡†ç¡®çš„å‚ç›´çº¦æŸ.<br>2ã€å¯¹é 0 flex å› å­çš„å­ç»„ä»¶,æŒ‰ç…§å…¶ flex å› å­å°†å‰©ä¸‹çš„æ°´å¹³ç©ºé—´åˆ†å‰².å¦‚ä¸€ä¸ª flex å› å­ä¸º 2.0 çš„å­ç»„ä»¶åœ¨æ°´å¹³ç©ºé—´ä¸Šå°†æ¯” flex å› å­æ˜¯ 1.0 çš„å­ç»„ä»¶å®½ 2 å€.<br>3ã€ä½¿ç”¨ç›¸åŒçš„å‚ç›´çº¦æŸæŒ‰ç…§æ­¥éª¤ 1 å¸ƒå±€å‰©ä¸‹çš„å­ç»„ä»¶,ä½¿ç”¨åŸºäºæ­¥éª¤ 2 ç”³è¯·åˆ°çš„ç©ºé—´ä½œä¸ºæ°´å¹³çº¦æŸè€Œä¸æ˜¯æ— è¾¹ç•Œæ°´å¹³çº¦æŸå¸ƒå±€.<code>Flexible.fit</code> å±æ€§å€¼ä¸º <code>FlexFit.tight</code> çš„å­ç»„ä»¶å—åˆ°ä¸¥æ ¼çº¦æŸ(å¦‚å¼ºåˆ¶å¡«å……ç”³è¯·åˆ°çš„ç©ºé—´),è€Œ <code>Flexible.fit</code> å±æ€§å€¼ä¸º <code>FlexFit.tight</code> çš„å­ç»„ä»¶çº¦æŸå®½æ¾(å¦‚ä¸å¼ºåˆ¶å¡«å……ç”³è¯·åˆ°çš„ç©ºé—´).<br>4ã€<code>Row</code> çš„é«˜åº¦æ€»æ˜¯æœ€å¤§å­ç»„ä»¶çš„é«˜åº¦(ä¸€èˆ¬æ»¡è¶³ä¼ å…¥çš„å‚ç›´çº¦æŸ).<br>5ã€<code>Row</code> çš„å®½åº¦ç”± <code>mainAxisSize</code> å±æ€§å†³å®š.å¦‚æœ <code>mainAxisSize</code> å±æ€§å€¼ä¸º <code>MainAxisSize.max</code>,é‚£ä¹ˆ <code>Row</code> çš„å®½åº¦æ˜¯ä¼ å…¥çº¦æŸçš„æœ€å¤§å®½åº¦.å¦‚æœ <code>mainAxisSize</code> çš„å€¼ä¸º <code>MainAxisSize.min</code>,é‚£ä¹ˆ <code>Row</code> çš„å®½åº¦æ˜¯æ‰€æœ‰å­ç»„ä»¶çš„å®½åº¦ä¹‹å’Œ(å—ä¼ å…¥çº¦æŸ).<br>6ã€æ ¹æ® <code>mainAxisAlignment</code> å’Œ <code>crossAxisAlignment</code> ç¡®å®šæ¯ä¸ªå­ç»„ä»¶çš„ä½ç½®.ä¾‹å¦‚,å¦‚æœ <code>mainAxisAlignment</code>æ˜¯ <code>MainAxisAlignment.spaceBetween</code>,<br>æ²¡æœ‰è¢«åˆ†é…ç»™å­ç»„ä»¶çš„ç©ºé—´å°†ä¼šå¹³å‡åˆ†é…åˆ°å„ä¸ªå­ç»„ä»¶ä¹‹é—´.</p>
<h2 id="ç»§æ‰¿-ğŸŒ²"><a href="#ç»§æ‰¿-ğŸŒ²" class="headerlink" title="ç»§æ‰¿ ğŸŒ²"></a>ç»§æ‰¿ ğŸŒ²</h2><p><code>Object &gt; Diagnosticable &gt; DiagnosticableTree &gt; Widget &gt; RenderObjectWidget &gt; MultiChildRenderObjectWidget &gt; Flex &gt; Column</code></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.dang8080.cn/2019/06/04/Flutter-Row/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Humphrey Dan">
      <meta itemprop="description" content="write something,donot leave.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="äº‘é’é’å…®æ¬²é›¨">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/06/04/Flutter-Row/" class="post-title-link" itemprop="url">Flutter-Row</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-06-04 13:28:18 / Modified: 23:22:42" itemprop="dateCreated datePublished" datetime="2019-06-04T13:28:18+08:00">2019-06-04</time>
            </span>

          
            <span id="/2019/06/04/Flutter-Row/" class="post-meta-item leancloud_visitors" data-flag-title="Flutter-Row" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2019/06/04/Flutter-Row/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/06/04/Flutter-Row/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ä»¥æ¨ªå‘æ•°ç»„çš„æ–¹å¼æ˜¾ç¤ºå­ç»„ä»¶çš„ç»„ä»¶.</p>
<p>ä¸ºäº†ä½¿å…¶ä¸€ä¸ªç»„ä»¶å¡«å……å‰©ä½™å¯ç”¨ç©ºé—´,å¯ä»¥ä½¿ç”¨ <code>Expanded</code>å¯¹å…¶è¿›è¡ŒåŒ…è£….</p>
<p><code>Row</code> ç»„ä»¶ä¸ä¼šæ»‘åŠ¨(é€šå¸¸ä¸€ä¸ª<code>Row</code>ç»„ä»¶ä¸­çš„å­ç»„ä»¶è¿‡å¤šå·²ç»è¶…å‡ºäº†å¯ç”¨ç©ºé—´,åˆ™ä¼šå¯¼è‡´é”™è¯¯).å¦‚æœåœ¨ä¸è¶³çš„ç©ºé—´ä¸­æƒ³è¦ä¸€æ’ç»„ä»¶èƒ½å¤Ÿæ»‘åŠ¨,å¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>ListView</code>.</p>
<p><code>Column</code> ç«–å‘æ’åˆ—.</p>
<p>å¦‚æœä»…æœ‰ä¸€ä¸ªå­ç»„ä»¶,é‚£ä¹ˆå¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>Align</code> æˆ– <code>Center</code> å®šä½è¯¥å­ç»„ä»¶.</p>
<h4 id="ä¸ºä»€ä¹ˆæˆ‘çš„-row-æœ‰ä¸€æ¡é»„é»‘ç›¸é—´çš„æ¡çº¹"><a href="#ä¸ºä»€ä¹ˆæˆ‘çš„-row-æœ‰ä¸€æ¡é»„é»‘ç›¸é—´çš„æ¡çº¹" class="headerlink" title="ä¸ºä»€ä¹ˆæˆ‘çš„ row æœ‰ä¸€æ¡é»„é»‘ç›¸é—´çš„æ¡çº¹?"></a>ä¸ºä»€ä¹ˆæˆ‘çš„ row æœ‰ä¸€æ¡é»„é»‘ç›¸é—´çš„æ¡çº¹?</h4><p>å¦‚æœ <code>Row</code>çš„å†…å®¹æ˜¯ä¸å¯ä¼¸ç¼©æ‰©å±•çš„(æ²¡æœ‰ä½¿ç”¨ <code>Expanded</code> æˆ– <code>Flexible</code> ç»„ä»¶åŒ…è£…),è¿åœ¨ä¸€èµ·æ¯” row æœ¬èº«æ›´å®½,é‚£ä¹ˆæˆ‘ä»¬å°±ç§° row æº¢å‡ºäº†.<br>å¦‚æœ row æº¢å‡ºäº†,é‚£ä¹ˆ row å°±æ²¡æœ‰å¤šä½™çš„ç©ºé—´å»åˆ†é…ç»™å®ƒçš„<code>Flexible</code> å’Œ <code>Expanded</code> å­ç»„ä»¶. row ä¼šåœ¨è¾¹ä¸Šæ˜¾ç¤ºä¸€æ¡é»„é»‘ç›¸é—´çš„æ¡è¡¨ç¤ºæº¢å‡ºäº†.å¦‚æœ row å¤–æœ‰ç©ºé—´,é‚£ä¹ˆæº¢å‡ºäº®å°†ä¼šä»¥çº¢è‰²å­—ä½“æ‰“å°å‡ºæ¥.</p>
<h2 id="å¸ƒå±€ç®—æ³•"><a href="#å¸ƒå±€ç®—æ³•" class="headerlink" title="å¸ƒå±€ç®—æ³•"></a>å¸ƒå±€ç®—æ³•</h2><blockquote>
<p>æ¥ä¸‹æ¥ä»‹ç» framework æ˜¯å¦‚ä½•æ¸²æŸ“ <code>Row</code> çš„.æŸ¥çœ‹ <code>BoxConstraints</code> äº†è§£ç›’å¸ƒå±€æ¨¡å‹.</p>
</blockquote>
<p><code>Row</code> çš„å¸ƒå±€åˆ†ä»¥ä¸‹ 6 æ­¥:<br>1ã€ä½¿ç”¨æ— è¾¹ç•Œçš„æ°´å¹³çº¦æŸå’Œä¼ å…¥çš„å‚ç›´çº¦æŸè®¾ç½®æ¯ä¸ªå­ç»„ä»¶ flex å› å­ä¸º null æˆ– 0.å¦‚æœ <code>crossAxisAlignment</code> å€¼ä¸º <code>CrossAxisAlignment.stetch</code>,ä½¿ç”¨æ»¡è¶³ä¼ å…¥çš„å‚ç›´çº¦æŸçš„æœ€å¤§é«˜åº¦è€Œä¸æ˜¯ä½¿ç”¨å‡†ç¡®çš„å‚ç›´çº¦æŸ.<br>2ã€å¯¹é 0 flex å› å­çš„å­ç»„ä»¶,æŒ‰ç…§å…¶ flex å› å­å°†å‰©ä¸‹çš„æ°´å¹³ç©ºé—´åˆ†å‰².å¦‚ä¸€ä¸ª flex å› å­ä¸º 2.0 çš„å­ç»„ä»¶åœ¨æ°´å¹³ç©ºé—´ä¸Šå°†æ¯” flex å› å­æ˜¯ 1.0 çš„å­ç»„ä»¶å®½ 2 å€.<br>3ã€ä½¿ç”¨ç›¸åŒçš„å‚ç›´çº¦æŸæŒ‰ç…§æ­¥éª¤ 1 å¸ƒå±€å‰©ä¸‹çš„å­ç»„ä»¶,ä½¿ç”¨åŸºäºæ­¥éª¤ 2 ç”³è¯·åˆ°çš„ç©ºé—´ä½œä¸ºæ°´å¹³çº¦æŸè€Œä¸æ˜¯æ— è¾¹ç•Œæ°´å¹³çº¦æŸå¸ƒå±€.<code>Flexible.fit</code> å±æ€§å€¼ä¸º <code>FlexFit.tight</code> çš„å­ç»„ä»¶å—åˆ°ä¸¥æ ¼çº¦æŸ(å¦‚å¼ºåˆ¶å¡«å……ç”³è¯·åˆ°çš„ç©ºé—´),è€Œ <code>Flexible.fit</code> å±æ€§å€¼ä¸º <code>FlexFit.tight</code> çš„å­ç»„ä»¶çº¦æŸå®½æ¾(å¦‚ä¸å¼ºåˆ¶å¡«å……ç”³è¯·åˆ°çš„ç©ºé—´).<br>4ã€<code>Row</code> çš„é«˜åº¦æ€»æ˜¯æœ€å¤§å­ç»„ä»¶çš„é«˜åº¦(ä¸€èˆ¬æ»¡è¶³ä¼ å…¥çš„å‚ç›´çº¦æŸ).<br>5ã€<code>Row</code> çš„å®½åº¦ç”± <code>mainAxisSize</code> å±æ€§å†³å®š.å¦‚æœ <code>mainAxisSize</code> å±æ€§å€¼ä¸º <code>MainAxisSize.max</code>,é‚£ä¹ˆ <code>Row</code> çš„å®½åº¦æ˜¯ä¼ å…¥çº¦æŸçš„æœ€å¤§å®½åº¦.å¦‚æœ <code>mainAxisSize</code> çš„å€¼ä¸º <code>MainAxisSize.min</code>,é‚£ä¹ˆ <code>Row</code> çš„å®½åº¦æ˜¯æ‰€æœ‰å­ç»„ä»¶çš„å®½åº¦ä¹‹å’Œ(å—ä¼ å…¥çº¦æŸ).<br>6ã€æ ¹æ® <code>mainAxisAlignment</code> å’Œ <code>crossAxisAlignment</code> ç¡®å®šæ¯ä¸ªå­ç»„ä»¶çš„ä½ç½®.ä¾‹å¦‚,å¦‚æœ <code>mainAxisAlignment</code>æ˜¯ <code>MainAxisAlignment.spaceBetween</code>,<br>æ²¡æœ‰è¢«åˆ†é…ç»™å­ç»„ä»¶çš„ç©ºé—´å°†ä¼šå¹³å‡åˆ†é…åˆ°å„ä¸ªå­ç»„ä»¶ä¹‹é—´.</p>
<h2 id="ç»§æ‰¿-ğŸŒ²"><a href="#ç»§æ‰¿-ğŸŒ²" class="headerlink" title="ç»§æ‰¿ ğŸŒ²"></a>ç»§æ‰¿ ğŸŒ²</h2><p><code>Object &gt; Diagnosticable &gt; DiagnosticableTree &gt; Widget &gt; RenderObjectWidget &gt; MultiChildRenderObjectWidget &gt; Flex &gt; Row</code></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.dang8080.cn/2019/06/04/flutter-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Humphrey Dan">
      <meta itemprop="description" content="write something,donot leave.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="äº‘é’é’å…®æ¬²é›¨">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/06/04/flutter-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">flutter å­¦ä¹ ç¬”è®°</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-06-04 13:01:00 / Modified: 13:26:02" itemprop="dateCreated datePublished" datetime="2019-06-04T13:01:00+08:00">2019-06-04</time>
            </span>

          
            <span id="/2019/06/04/flutter-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-meta-item leancloud_visitors" data-flag-title="flutter å­¦ä¹ ç¬”è®°" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2019/06/04/flutter-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/06/04/flutter-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>flutter çš„æ ¸å¿ƒè®¾è®¡æ˜¯å°†æ•´ä¸ªåº”ç”¨çš„å„ä¸ªéƒ¨åˆ†å„ä¸ªå±‚çº§éƒ½çœ‹ä½œ Widget æ¥æ¸²æŸ“,æ‰€ä»¥æŒ‰ç…§ Widget çš„åˆ†ç±»æ¥å­¦ä¹ ä¼šæ¯”è¾ƒå…¨é¢ã€‚</p>
<h2 id="åŸºç¡€ç»„ä»¶"><a href="#åŸºç¡€ç»„ä»¶" class="headerlink" title="åŸºç¡€ç»„ä»¶"></a>åŸºç¡€ç»„ä»¶</h2><h3 id="Container"><a href="#Container" class="headerlink" title="Container"></a>Container</h3><ul>
<li>Row</li>
<li>Column</li>
<li>Image</li>
<li>Text</li>
<li>Icon</li>
<li>RaisedButton</li>
<li>Scaffold</li>
<li>AppBar</li>
<li>FlutterLogo</li>
<li>Placeholder</li>
</ul>
<h2 id="Material-ç»„ä»¶"><a href="#Material-ç»„ä»¶" class="headerlink" title="Material ç»„ä»¶"></a>Material ç»„ä»¶</h2><h3 id="ç»“æ„å’Œå¯¼èˆª"><a href="#ç»“æ„å’Œå¯¼èˆª" class="headerlink" title="ç»“æ„å’Œå¯¼èˆª"></a>ç»“æ„å’Œå¯¼èˆª</h3><ul>
<li>Scaffold</li>
<li>AppBar</li>
<li>BottomNavigationBar</li>
<li>TabBar</li>
<li>TabBarView</li>
<li>MaterialApp</li>
<li>WidgetsApp</li>
<li>Drawer</li>
</ul>
<h3 id="æŒ‰é’®"><a href="#æŒ‰é’®" class="headerlink" title="æŒ‰é’®"></a>æŒ‰é’®</h3><ul>
<li>RaisedButton</li>
<li>FloatingActionButton</li>
<li>FlatButton</li>
<li>IconButton</li>
<li>PopupMenuButton</li>
<li>ButtonBar</li>
</ul>
<h3 id="è¾“å…¥æ¡†å’Œé€‰æ‹©æ¡†"><a href="#è¾“å…¥æ¡†å’Œé€‰æ‹©æ¡†" class="headerlink" title="è¾“å…¥æ¡†å’Œé€‰æ‹©æ¡†"></a>è¾“å…¥æ¡†å’Œé€‰æ‹©æ¡†</h3><ul>
<li>TextField</li>
<li>Checkbox</li>
<li>Radio</li>
<li>Switch</li>
<li>Slider</li>
<li>Date &amp; Time Pickers</li>
</ul>
<h3 id="å¯¹è¯æ¡†-Alert-Panel"><a href="#å¯¹è¯æ¡†-Alert-Panel" class="headerlink" title="å¯¹è¯æ¡†,Alert Panel"></a>å¯¹è¯æ¡†,Alert Panel</h3><ul>
<li>SimpleDialog</li>
<li>AlertDialog</li>
<li>BottomSheet</li>
<li>ExpansionPanel</li>
<li>SnackBar</li>
</ul>
<h3 id="ä¿¡æ¯å±•ç¤º"><a href="#ä¿¡æ¯å±•ç¤º" class="headerlink" title="ä¿¡æ¯å±•ç¤º"></a>ä¿¡æ¯å±•ç¤º</h3><ul>
<li>Image</li>
<li>Icon</li>
<li>Chip</li>
<li>Tooltip</li>
<li>DataTable</li>
<li>Card</li>
<li>LinearProgressIndicator</li>
</ul>
<h3 id="å¸ƒå±€"><a href="#å¸ƒå±€" class="headerlink" title="å¸ƒå±€"></a>å¸ƒå±€</h3><ul>
<li>ListTile</li>
<li>Stepper</li>
<li>Divider</li>
</ul>
<h2 id="Cupertino"><a href="#Cupertino" class="headerlink" title="Cupertino"></a>Cupertino</h2><ul>
<li>CupertinoActivityIndicator</li>
<li>CupertinoAlertDialog</li>
<li>CupertinoButton</li>
<li>CupertinoDialog</li>
<li>CupertinoDialogAction</li>
<li>CupertinoSlider</li>
<li>CupertinoSwitch</li>
<li>CupertinoPageTransition</li>
<li>CupertinoFullScreenDialogTransition</li>
<li>CupertinoNavigationBar</li>
<li>CupertinoTabBar</li>
<li>CupertinoPageScaffold</li>
<li>CupertinoTabScaffold</li>
<li>CupertinoTabView</li>
</ul>
<h2 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h2><h3 id="å•ä¸ªå…ƒç´ "><a href="#å•ä¸ªå…ƒç´ " class="headerlink" title="å•ä¸ªå…ƒç´ "></a>å•ä¸ªå…ƒç´ </h3><ul>
<li>Container</li>
<li>Padding</li>
<li>Center</li>
<li>Align</li>
<li>FittedBox</li>
<li>AspectRatio</li>
<li>ConstrainedBox</li>
<li>Baseline</li>
<li>FractionallySizedBox</li>
<li>IntrinsicHeight</li>
<li>IntrinsicWidth</li>
<li>LimitedBox</li>
<li>Offstage</li>
<li>OverflowBox</li>
<li>SizedBox</li>
<li>SizedOverflowBox</li>
<li>Transform</li>
<li>CustomSingleChildLayout</li>
</ul>
<h3 id="å¤šä¸ªå…ƒç´ "><a href="#å¤šä¸ªå…ƒç´ " class="headerlink" title="å¤šä¸ªå…ƒç´ "></a>å¤šä¸ªå…ƒç´ </h3><ul>
<li>Row</li>
<li>Column</li>
<li>Stack</li>
<li>IndexedStack</li>
<li>Flow</li>
<li>Table</li>
<li>Wrap</li>
<li>ListBody</li>
<li>ListView</li>
<li>CustomMultiChildLayout</li>
</ul>
<h3 id="LayoutBuilder"><a href="#LayoutBuilder" class="headerlink" title="LayoutBuilder"></a>LayoutBuilder</h3><h2 id="Text"><a href="#Text" class="headerlink" title="Text"></a>Text</h2><ul>
<li>Text</li>
<li>RichText</li>
<li>DefaultTextStyle</li>
</ul>
<h2 id="Assets"><a href="#Assets" class="headerlink" title="Assets"></a>Assets</h2><ul>
<li>Image</li>
<li>Icon</li>
<li>RawImage</li>
<li>AssetBundle</li>
</ul>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><ul>
<li>Form</li>
<li>FormField</li>
<li>RawKeyboardListener</li>
</ul>
<h2 id="Animation"><a href="#Animation" class="headerlink" title="Animation"></a>Animation</h2><ul>
<li>AnimatedContainer</li>
<li>AnimatedCrossFade</li>
<li>Hero</li>
<li>AnimatedBuilder</li>
<li>DecoratedBoxTransition</li>
<li>FadeTransition</li>
<li>PositionedTransition</li>
<li>RotationTransition</li>
<li>ScaleTransition</li>
<li>SizeTransition</li>
<li>SlideTransition</li>
<li>AnimatedDefaultTextStyle</li>
<li>AnimatedListState</li>
<li>AnimatedModalBarrier</li>
<li>AnimatedOpacity</li>
<li>AnimatedPhysicalModal</li>
<li>AnimatedPositioned</li>
<li>AnimatedSize</li>
<li>AnimatedWidget</li>
<li>AnimatedWidgetBaseState</li>
</ul>
<h2 id="äº¤äº’"><a href="#äº¤äº’" class="headerlink" title="äº¤äº’"></a>äº¤äº’</h2><ul>
<li>LongPressDraggable</li>
<li>GestureDetector</li>
<li>DragTarget</li>
<li>Dismissible</li>
<li>IgnorePointer</li>
<li>AbsorbPointer</li>
<li>Navigator</li>
<li>Scrollable</li>
</ul>
<h2 id="æ ·å¼"><a href="#æ ·å¼" class="headerlink" title="æ ·å¼"></a>æ ·å¼</h2><ul>
<li>Padding</li>
<li>Theme</li>
<li>MediaQuery</li>
</ul>
<h2 id="Draw"><a href="#Draw" class="headerlink" title="Draw"></a>Draw</h2><ul>
<li>Opacity</li>
<li>Transform</li>
<li>DecoratedBox</li>
<li>FractionalTransition</li>
<li>RotatedBox</li>
<li>ClipOval</li>
<li>ClipPath</li>
<li>ClipRect</li>
<li>CustomPaint</li>
<li>BackdropFilter</li>
</ul>
<h2 id="Async"><a href="#Async" class="headerlink" title="Async"></a>Async</h2><ul>
<li>FutureBuilder</li>
<li>StreamBuilder</li>
</ul>
<h2 id="æ»šåŠ¨"><a href="#æ»šåŠ¨" class="headerlink" title="æ»šåŠ¨"></a>æ»šåŠ¨</h2><ul>
<li>ListView</li>
<li>NestedScrollView</li>
<li>GridView</li>
<li>SingleChildScrollView</li>
<li>Scrollable</li>
<li>Scrollbar</li>
<li>CustomScrollView</li>
<li>NotificationListener</li>
<li>ScrollConfiguration</li>
<li>RefreshIndicator</li>
</ul>
<h2 id="è¾…åŠ©"><a href="#è¾…åŠ©" class="headerlink" title="è¾…åŠ©"></a>è¾…åŠ©</h2><ul>
<li>Semantics</li>
<li>MergeSemantics</li>
<li>ExcludeSemantics</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.dang8080.cn/2019/05/05/GraphQL-Batching/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Humphrey Dan">
      <meta itemprop="description" content="write something,donot leave.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="äº‘é’é’å…®æ¬²é›¨">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/05/GraphQL-Batching/" class="post-title-link" itemprop="url">GraphQL-Batching</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-05-05 23:38:54" itemprop="dateCreated datePublished" datetime="2019-05-05T23:38:54+08:00">2019-05-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-05-06 16:42:20" itemprop="dateModified" datetime="2019-05-06T16:42:20+08:00">2019-05-06</time>
              </span>

          
            <span id="/2019/05/05/GraphQL-Batching/" class="post-meta-item leancloud_visitors" data-flag-title="GraphQL-Batching" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2019/05/05/GraphQL-Batching/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/05/05/GraphQL-Batching/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="æ‰¹å¤„ç†"><a href="#æ‰¹å¤„ç†" class="headerlink" title="æ‰¹å¤„ç†"></a>æ‰¹å¤„ç†</h2><h3 id="ä½¿ç”¨-Dataloader"><a href="#ä½¿ç”¨-Dataloader" class="headerlink" title="ä½¿ç”¨ Dataloader"></a>ä½¿ç”¨ Dataloader</h3><p>å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ graphql,é‚£ä¹ˆä½ å¯èƒ½é‡åˆ°æ•°æ®å›¾æŸ¥è¯¢.è¿™å¯ä»¥é€šè¿‡æœ¬åœ°æ•°æ®å›¾åŠ è½½è½»æ¾å®ç°.<br>ä½¿ç”¨ <code>java-dataloader</code> å°†å¸®åŠ©ä½ æ›´é«˜æ•ˆçš„å¤„ç†æ•°æ®å›¾æ¡ç›®çš„ç¼“å­˜å’Œæ‰¹é‡è¯·æ±‚.å¦‚æœ dataloader å·²ç»å‘ç°äº†ä¸€ä¸ªä¹‹å‰çš„æ•°æ®æ¡ç›®,å®ƒå°†ä¼šç¼“å­˜æ•°æ®å¹¶ä¸”ç›´æ¥è¿”å›ä¸å†å‘èµ·è¯·æ±‚.<br>å‡è®¾æˆ‘ä»¬éœ€è¦æŸ¥è¯¢ä¸€ä¸ªè‹±é›„å’Œä»–ä»¬æœ‹å‹çš„åå­—åŠä»–ä»¬æœ‹å‹çš„æœ‹å‹çš„åå­—.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    hero &#123;</span><br><span class="line">        name &#123;</span><br><span class="line">            friends &#123;</span><br><span class="line">                name &#123;</span><br><span class="line">                    friends &#123;</span><br><span class="line">                        name</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæŸ¥è¯¢çš„ç»“æœå¦‚ä¸‹.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">"hero"</span>: &#123;</span><br><span class="line">		<span class="attr">"name"</span>: <span class="string">"R2-D2"</span>,</span><br><span class="line">		<span class="attr">"friends"</span>: [</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="attr">"name"</span>: <span class="string">"Luke Skywalker"</span>,</span><br><span class="line">				<span class="attr">"friends"</span>: [</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="attr">"name"</span>: <span class="string">"HanSolo"</span></span><br><span class="line">					&#125;,</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="attr">"name"</span>: <span class="string">"Leia Organa"</span></span><br><span class="line">					&#125;,</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="attr">"name"</span>: <span class="string">"C-3P0"</span></span><br><span class="line">					&#125;,</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="attr">"name"</span>: <span class="string">"R2-D2"</span></span><br><span class="line">					&#125;</span><br><span class="line">				]</span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="attr">"name"</span>: <span class="string">"Han Solo"</span>,</span><br><span class="line">				<span class="attr">"friends"</span>: [</span><br><span class="line">					&#123; <span class="attr">"name"</span>: <span class="string">"Luke Skywalker"</span> &#125;,</span><br><span class="line">					&#123; <span class="attr">"name"</span>: <span class="string">"Leia Organa"</span> &#125;,</span><br><span class="line">					&#123; <span class="attr">"name"</span>: <span class="string">"R2-D2"</span> &#125;</span><br><span class="line">				]</span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="attr">"name"</span>: <span class="string">"Leia Organa"</span>,</span><br><span class="line">				<span class="attr">"friends"</span>: [</span><br><span class="line">					&#123; <span class="attr">"name"</span>: <span class="string">"Luke Skywalker"</span> &#125;,</span><br><span class="line">					&#123; <span class="attr">"name"</span>: <span class="string">"Han Solo"</span> &#125;,</span><br><span class="line">					&#123; <span class="attr">"name"</span>: <span class="string">"C-3PO"</span> &#125;,</span><br><span class="line">					&#123; <span class="attr">"name"</span>: <span class="string">"R2-D2"</span> &#125;</span><br><span class="line">				]</span><br><span class="line">			&#125;</span><br><span class="line">		]</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€å·®çš„åŠæ³•æ˜¯æ¯æ¬¡è°ƒç”¨ <code>DataFetcher</code>è·å– person å¯¹è±¡.<br>æœ¬ä¾‹ä¸­å°†å‘èµ· 15 æ¬¡ç½‘ç»œè¯·æ±‚.å³ä½¿å¾ˆå¤šäººæœ‰å…±åŒçš„æœ‹å‹.ä½¿ç”¨ <code>dataloader</code>ä½ å¯ä»¥ä½¿ graphql æŸ¥è¯¢å˜å¾—æ›´é«˜æ•ˆ.<br>å½“ graphql é™åºæŸ¥è¯¢æ¯ä¸ªå±‚çº§æ—¶(hero -&gt; friends -&gt; friends),dataloader è°ƒç”¨ promise ä¼ é€’ person å¯¹è±¡.åœ¨æ¯ä¸ªå±‚çº§ä¸­è°ƒç”¨ <code>dataloader.dispatch()</code> æ‰¹é‡å‘èµ·éƒ¨åˆ†æŸ¥è¯¢è¯·æ±‚.åŠ ä¸Šç¼“å­˜(é»˜è®¤ä½¿ç”¨),ä¹‹å‰çš„ person å°†è¢«è¿”å›.<br>ä¸Šä¾‹ä¸­åªæ¶‰åŠåˆ° 5 ä¸ªç‹¬ç«‹çš„ people,åˆç†çš„ä½¿ç”¨ç¼“å­˜å’Œæ‰¹é‡è¯·æ±‚å°†åªæœ‰ 3 ä¸ªæ‰¹é‡åŠ è½½å‡½æ•°è¢«è°ƒç”¨,3 ä¸ªç½‘ç»œè¯·æ±‚æˆ–æ•°æ®åº“æŸ¥è¯¢æ€»æ¯” 15 ä¸ªè¦å¥½.<br>å¦‚æœä½ ä½¿ç”¨äº† <code>java.util.concurrent.CompletableFuture.supplyAsync()</code>,é‚£ä¹ˆä½ å¯ä»¥é€šè¿‡å¼‚æ­¥è°ƒç”¨ä½¿æŸ¥è¯¢å˜å¾—æ›´é«˜æ•ˆ.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  batch loader å¯èƒ½è¢«è°ƒç”¨å¤šæ¬¡ï¼Œå› ä¸ºå®ƒçš„æ— çŠ¶æ€æ€§ï¼Œæ‰€ä»¥é€‚åˆä½œä¸ºå•ä¾‹ä½¿ç”¨</span></span><br><span class="line">BatchLoader&lt;String,Object&gt; characterBatchLoader = <span class="keyword">new</span> BatchLoader&lt;String,Object&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> CompletableStage&lt;List&lt;Object&gt;&gt; load(List&lt;String&gt; keys) &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ supplyAsync() æœ€å¤§åŒ–å¹¶è¡Œæ‰§è¡Œ</span></span><br><span class="line">        <span class="keyword">return</span> CompletableFuture.supplyAsync(() -&gt; getCharacterDataViaBatchHTTPApi(keys));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™ä¸ª data laoder è·å–å…³è”çš„äººç‰©ï¼ŒæŠŠä»–ä»¬æ”¾å…¥ graphql schema</span></span><br><span class="line">DataFetcher heroDataFetcher = <span class="keyword">new</span> DataFetcher() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(DataFetchingEnvironment environment)</span> </span>&#123;</span><br><span class="line">        DataLoader&lt;String,Object&gt; dataloader = environment.getDataLoader(<span class="string">"character"</span>);</span><br><span class="line">        <span class="keyword">return</span> dataloader.load(<span class="string">"2001"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">DataFetcher friendsDataFetcher = <span class="keyword">new</span> DataFetcher() &#123;</span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(DataFetchingEnvironment environment)</span> </span>&#123;</span><br><span class="line">        StarWarsCharacter starWarsCharacter = environment.getSource();</span><br><span class="line">        List&lt;String&gt; friendsIds = starWarsCharacter.getFriendIds();</span><br><span class="line">        DataLoader&lt;String,Object&gt; dataloader = environment.getDataLoader(<span class="string">"character"</span>);</span><br><span class="line">        <span class="keyword">return</span> dataloader.loadMany(friendsIds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">DataLoaderDispatcherInstrumentationOptions options = DataLoaderDispatcherInstrumentationOptions.newOptions().includeStatistics(<span class="keyword">true</span>);</span><br><span class="line">DataLoaderDispatcherInstrumentation dispatcherInstrumentation = <span class="keyword">new</span> DataLoaderDispatcherInstrumentation(options);</span><br><span class="line">GraphQL graphql = GraphQL.newGraphQL(buildSchema())</span><br><span class="line">    .instrumentation(dispatcherInstrumentation)</span><br><span class="line">    .build();</span><br><span class="line"><span class="comment">// å› ä¸º data loader æ˜¯æœ‰çŠ¶æ€çš„,æ‰€ä»¥æ¯æ¬¡è¯·æ±‚éƒ½ä¼šè¢«æ‰§è¡Œ</span></span><br><span class="line">DataLoader&lt;String,Object&gt; characterDataLoader = DataLoader.newDataLoader(characterBatchLoader);</span><br><span class="line">DataLoaderRegistry registry = <span class="keyword">new</span> DataLoaderRegistry();</span><br><span class="line">registry.register(<span class="string">"character"</span>,characterDataLoader);</span><br><span class="line"></span><br><span class="line">ExecutionInput executionInput = newExecutionInput()</span><br><span class="line">    .query(getQuery())</span><br><span class="line">    .dataLoaderRegistry(registry)</span><br><span class="line">    .build();</span><br><span class="line">ExecutionResult executionResult = graphql.execute(executionInput);</span><br></pre></td></tr></table></figure>

<p>æœ¬ä¾‹ä¸­å› ä¸ºæˆ‘ä»¬éœ€è¦å¾®è°ƒ <code>DataLoaderDispatcherInstrumentation</code>é€‰é¡¹,æ‰€ä»¥æ‰‹åŠ¨æ·»åŠ .å¦‚æœä¸è¦çš„è¯,é»˜è®¤ä¼šè‡ªåŠ¨æ·»åŠ çš„.</p>
<h3 id="ä»…é€‚ç”¨äº-AsyncExecutionStrategy-çš„-Data-Loader"><a href="#ä»…é€‚ç”¨äº-AsyncExecutionStrategy-çš„-Data-Loader" class="headerlink" title="ä»…é€‚ç”¨äº AsyncExecutionStrategy çš„ Data Loader"></a>ä»…é€‚ç”¨äº AsyncExecutionStrategy çš„ Data Loader</h3><p>è¿™æ˜¯å› ä¸ºæ­¤æ‰§è¡Œç­–ç•¥çŸ¥é“åœ¨æœ€ä½³æ—¶æœºåˆ†å‘ä½ çš„ load è°ƒç”¨.å®ƒé€šè¿‡æ·±åº¦è¿½è¸ªä½ æœ‰å¤šå°‘ä¸ªçªå‡ºçš„å±æ€§åŠä»–ä»¬æ˜¯å¦æ˜¯åˆ—è¡¨å€¼ç­‰å®ç°.<br>å…¶ä»–ç­–ç•¥å¦‚ <code>ExecutorServiceExecutionStrategy</code>æ— æ³•å®ç°è¿™ä¸ªåŠŸèƒ½,å› ä¸ºå¦‚æœ data loader ä»£ç æ£€æµ‹åˆ°ä½ æ²¡æœ‰ä½¿ç”¨ <code>AsyncExecitionStrategy</code>,é‚£ä¹ˆå½“ç¢°åˆ°æ¯ä¸ªå±æ€§æ—¶,å®ƒå°†ç®€å•çš„åˆ†å‘ data loader.ä½ å¯èƒ½ä¼šå¾—åˆ°å€¼çš„ <code>caching</code>,ä½†ä½ ç»å¯¹æ‹¿ä¸åˆ°ä»–ä»¬çš„ <code>batching</code>.</p>
<h3 id="Data-Loader-çš„æ¯ä¸€ä¸ªè¯·æ±‚"><a href="#Data-Loader-çš„æ¯ä¸€ä¸ªè¯·æ±‚" class="headerlink" title="Data Loader çš„æ¯ä¸€ä¸ªè¯·æ±‚"></a>Data Loader çš„æ¯ä¸€ä¸ªè¯·æ±‚</h3><p>å¦‚æœä½ æ­£åœ¨ä¸º web è¯·æ±‚æä¾›æœåŠ¡,é‚£ä¹ˆå¯ä»¥ä¸ºç”¨æˆ·è¯·æ±‚æŒ‡å®šæ•°æ®.å¦‚æœä½ æœ‰ç”¨æˆ·æŒ‡å®šçš„æ•°æ®,ä½ å¯èƒ½ä¸ä¼šç¼“å­˜ç”¨æˆ· a çš„æ•°æ®,ç„¶ååœ¨åç»­çš„è¯·æ±‚ä¸­æŠŠå®ƒä¼ é€’ç»™ç”¨æˆ· b.<br>ä½ çš„ DataLoader å®ä¾‹çš„èŒƒå›´æ˜¯å¾ˆé‡è¦çš„.ä½ å¯èƒ½æƒ³æ¯ä¸ª web è¯·æ±‚åˆ›å»ºä¸€ä¸ª dataloader ä»¥ç¡®ä¿æ•°æ®åªå¯¹ç‰¹å®šçš„ web è¯·æ±‚ç¼“å­˜.åŒæ—¶ç¡®ä¿ <code>dispatch</code>è°ƒç”¨ä¸å½±å“å…¶ä»–çš„ graphql æ‰§è¡Œ.<br>DataLoader é»˜è®¤è¡Œä¸ºç±»ä¼¼ç¼“å­˜.å¦‚æœå‘ç°ä¹‹å‰å­˜åœ¨æŸä¸ª key å¯¹åº”çš„å€¼,é‚£ä¹ˆä¼šè‡ªåŠ¨è¿”å›å®ƒ.<br>å¦‚æœä½ çš„æ•°æ®å¯ä»¥è·¨ web è¯·æ±‚åˆ†äº«,é‚£ä¹ˆä½ å¯èƒ½éœ€è¦æ”¹å˜ä½ çš„ data loader ç¼“å­˜å®ç°,è¿™æ ·ä»–ä»¬å°±èƒ½é€šè¿‡å¦‚ memcached æˆ– redis è¿™æ ·çš„ç¼“å­˜å±‚è¿›è¡Œæ•°æ®åˆ†äº«.<br>ä¸‹ä¾‹ä¸­ä»ç„¶æ¯ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ª data loader,ç„¶è€Œç¼“å­˜å±‚å…è®¸æ•°æ®åˆ†äº«.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">CacheMap&lt;String,Object&gt; crossRequestCacheMap = <span class="keyword">new</span> CacheMap&lt;String,Object&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsKey</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisIntegration.containsKey(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisIntegration.getValue(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CacheMap&lt;String,Object&gt; <span class="title">set</span><span class="params">(String key,Object value)</span> </span>&#123;</span><br><span class="line">        redisIntegration.setValue(key,value);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CacheMap&lt;String,Object&gt; <span class="title">delete</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        redisIntegration.clearKey(key);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CacheMap&lt;String,Object&gt; <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        redisIntegration.clearAll();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">DataLoaderOptions options = DataLoaderOptions.newOptions().setCacheMap(crossRequestCacheMap);</span><br><span class="line">DataLoader&lt;String,Object&gt; dataloader = DataLoader.newDataLoader(batchLoader,options);</span><br></pre></td></tr></table></figure>

<h3 id="åªèƒ½å¼‚æ­¥è°ƒç”¨çš„æ‰¹é‡åŠ è½½åŠŸèƒ½"><a href="#åªèƒ½å¼‚æ­¥è°ƒç”¨çš„æ‰¹é‡åŠ è½½åŠŸèƒ½" class="headerlink" title="åªèƒ½å¼‚æ­¥è°ƒç”¨çš„æ‰¹é‡åŠ è½½åŠŸèƒ½"></a>åªèƒ½å¼‚æ­¥è°ƒç”¨çš„æ‰¹é‡åŠ è½½åŠŸèƒ½</h3><p>æ­¤ dataloader ä»£ç æ¨¡å¼æ•´åˆæ‰€æœ‰æ˜æ˜¾çš„ data loader è°ƒç”¨åˆ°ä¸€ä¸ªæ›´æœ‰æ•ˆçš„æ‰¹é‡åŠ è½½è°ƒç”¨.<br>graphql-java è¿½è¸ªå·²å‘èµ·çš„æ˜æ˜¾çš„ data loader è°ƒç”¨,ç„¶ååœ¨æœ€åˆé€‚çš„æ—¶æœº(å³æ‰€æœ‰çš„ graphql å±æ€§å·²ç»æ ¡éªŒæˆåŠŸå¹¶åˆ†å‘)åœ¨åå°è°ƒç”¨<code>dispatch</code>.<br>ç„¶è€Œæœ‰äº›æƒ…å†µä¸‹å°†å¯¼è‡´ä½ çš„ data loader è°ƒç”¨æ°¸ä¸ä¼šå®Œæˆ,è¿™ä¸­æƒ…å†µå¿…é¡»é¿å….è¿™ç§æƒ…å†µåŒ…æ‹¬åœ¨å¼‚æ­¥çº¿ç¨‹è°ƒç”¨ <code>DataLoader</code>.<br>ä¸‹é¢çš„ ğŸŒ° ä¸ä¼šæˆåŠŸ(å°†æ°¸è¿œæ— æ³•å®Œæˆ).</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">BatchLoader&lt;String,Object&gt; batchLoader = <span class="keyword">new</span> BatchLoader&lt;String,Object&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> CompletionStage&lt;List&lt;Object&gt;&gt; load(List&lt;String&gt; keys) &#123;</span><br><span class="line">        <span class="keyword">return</span> CompletableFuture.completedFuture(getTheseCharacters(keys));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">DataLoader&lt;String,Object&gt; characterDataLoader = DataLoader.newDataLoader(batchLoader);</span><br><span class="line"></span><br><span class="line">DataFetcher dataFetcherThatCallsTheDataLoader = <span class="keyword">new</span> DataFetcher() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(DataFetchingEnvironment environment)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// åƒä¸‡è¦é¿å…è¿™æ ·åš</span></span><br><span class="line">        <span class="keyword">return</span> CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            String argId = environment.getArgument(<span class="string">"id"</span>);</span><br><span class="line">            DataLoader&lt;String,Object&gt; characterLoader = environment.getDataLoader(<span class="string">"characterLoader"</span>);</span><br><span class="line">            <span class="keyword">return</span> characterLoader.load(argId);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ ğŸŒ° ä¸­,<code>characterDataLoader.load(argId)</code> å¯ä»¥åœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹çš„æœªæ¥æŸä¸ªæ—¶åˆ»è¢«è°ƒç”¨. graphql-java å¼•æ“ä¸çŸ¥é“ä½•æ—¶æ˜¯æœ€ä½³æ—¶æœºå»åˆ†å‘æ˜æ˜¾çš„ <code>DataLoader</code> è°ƒç”¨,å› æ­¤è¿™ä¸ª data loader å¯èƒ½æ°¸è¿œä¸ä¼šå¦‚æœŸæ‰§è¡Œ,ä¹Ÿä¸ä¼šæœ‰ç»“æœè¿”å›.<br>è¯·è®°ä½,data loader è°ƒç”¨ä»…ä»…æ˜¯ä¸€ä¸ªä¿è¯,åé¢ä¼šå°†æ˜æ˜¾çš„è°ƒç”¨æ‰¹é‡è°ƒç”¨åœ¨åˆé€‚çš„æ—¶æœºè·å–ç»“æœ.æœ€ä½³æ—¶æœºæ˜¯ graphql å±æ€§æ ‘å·²ç»æ ¡éªŒè¿‡,ä¸”æ‰€æœ‰çš„å±æ€§å€¼å·²ç»è¢«åˆ†å‘.<br>ä¸‹é¢çš„ ğŸŒ° ä¾ç„¶æ˜¯å¼‚æ­¥ä»£ç ,ä½†æ˜¯æŠŠå®ƒæ”¾åœ¨ <code>BatchLoader</code> é‡Œ.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">BatchLoader&lt;String,Object&gt; batchLoader = <span class="keyword">new</span> BatchLoader&lt;String,Object&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> CompletionStage&lt;List&lt;Object&gt;&gt; load(List&lt;String&gt; keys) &#123;</span><br><span class="line">        <span class="keyword">return</span> CompletableFuture.supplyAsync(() -&gt; getThreseCharacters(keys));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">DataLoader&lt;String,Object&gt; characterDataLoader = DataLoader.newDataLoader(batchLoader);</span><br><span class="line"></span><br><span class="line">DataFetcher dataFetcherThatCallsTheDataLoader = <span class="keyword">new</span> DataFetcher() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(DataFetchingEnvironment environment)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// è¿™æ˜¯é˜”ä»¥æ»´</span></span><br><span class="line">        String argId = environment.getArgument(<span class="string">"id"</span>);</span><br><span class="line">        DataLoader&lt;String,Object&gt; characterLoader = environment.getDataLoader(<span class="string">"characterLoader"</span>);</span><br><span class="line">        <span class="keyword">return</span> characterLoader.load(argId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ ğŸŒ° <code>characterDataLoader.load(argId)</code> ä¼šç«‹å³è¿”å›.è¿™å°†ä¼šæŠŠ data è¯·æ±‚å…¥é˜Ÿåˆ—,z å½“æ‰€æœ‰çš„ graphql å±æ€§éƒ½åˆ†å‘åå†æ‰§è¡Œ.<br>ç„¶åå½“ <code>DataLoader</code> è¢«åˆ†å‘å,ä»–çš„ <code>BatchLoader</code> å‡½æ•°è¢«è°ƒç”¨.è¿™ä¸ªä»£ç å¯ä»¥å¼‚æ­¥æ‰§è¡Œ,æ‰€ä»¥ä½ å¯ä»¥æœ‰å¤šä¸ªæ‰¹é‡åŠ è½½å‡½æ•°,ä»–ä»¬å¯ä»¥åŒæ—¶æ‰§è¡Œ.åœ¨ä¸Šä¾‹ä¸­ <code>CompletableFuture.supplyAsync(() -&gt; getTheseCharacters(keys));</code> å°†å†å¦ä¸€ä¸ªçº¿ç¨‹ä¸­è¿”å› <code>getTheseCharacters()</code> æ–¹æ³•.</p>
<h3 id="å‘ä½ çš„-data-loader-ä¼ é€’-context"><a href="#å‘ä½ çš„-data-loader-ä¼ é€’-context" class="headerlink" title="å‘ä½ çš„ data loader ä¼ é€’ context"></a>å‘ä½ çš„ data loader ä¼ é€’ context</h3><p>data load åº“æ”¯æŒä¼ é€’ä¸¤ä¸ªç±»å‹çš„ context åˆ° batch loader.ç¬¬ä¸€ä¸ªæ˜¯æ¯ä¸ª dataloader ä¸€ä¸ªå…¨å±€çš„ context å¯¹è±¡,ç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ª loaded key ä¸€ä¸ª context å¯¹è±¡çš„ map.<br>è¿™å…è®¸ä½ ä¼ é€’ä¸‹æ¸¸éœ€è¦çš„é¢å¤–ä¿¡æ¯.dataloader key ç”¨åœ¨ç¼“å­˜ç»“æœ,è€Œ context å¯¹è±¡å¯ä»¥ç”¨åœ¨è°ƒç”¨ä¸­.<br>åœ¨ä¸‹é¢çš„ ğŸŒ° ä¸­,æˆ‘ä»¬æœ‰ä¸€ä¸ªå…¨å±€çš„å®‰å…¨ context å¯¹è±¡,æä¾›äº†ä¸€ä¸ªè°ƒç”¨ token,åŒæ—¶å¯ä»¥ä¼ é€’ graphql åŸå¯¹è±¡åˆ°æ¯ä¸ª <code>dataLoader.load()</code> è°ƒç”¨ä¸­.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">BatchLoaderWithContext&lt;String,Object&gt; batchLoaderWithCtx = <span class="keyword">new</span> BatchLoaderWithContext&lt;String,Object&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> CompletionStage&lt;List&lt;Object&gt;&gt; load(List&lt;String&gt; keys,BatchLoaderEnvironment loaderContext) &#123;</span><br><span class="line">        <span class="comment">// è·å–å…¨å±€ context å¯¹è±¡</span></span><br><span class="line">        SecurityContext sercurityCtx = loaderContext.getContext();</span><br><span class="line">        <span class="comment">// æ¯ä¸ªé”®éƒ½æœ‰ä¸€ä¸ª context å¯¹è±¡é›†</span></span><br><span class="line">        Map&lt;Object,Object&gt; keysToSOurceObjects = loaderContext.getKeyContexts();</span><br><span class="line">        <span class="keyword">return</span> CompletableFuture.supplyAsync(() -&gt; getTheseCharacters(securityCtx.getToken(),keys,keysToSourceObjects));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">SecurityContext securityCtx = SecurityContext.newSecurityContext();</span><br><span class="line">BatchLoaderContextProvider contextProvider = <span class="keyword">new</span> BatchLoaderContextProvider() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object getÃ‡ontext() &#123;</span><br><span class="line">        <span class="keyword">return</span> securityCtx;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">DataLoaderOptions loaderOptions = DataLoaderOptions.newOptions().setBatchLoaderContextProvider(contextProvider);</span><br><span class="line">DataLoader&lt;String,Object&gt; characterDataLoader = DataLoader.newDataLoader(batchLoaderWithCtx,loaderOptions);</span><br><span class="line"></span><br><span class="line">DataFetcher dataFetcherCallsTheDataLoader = <span class="keyword">new</span> DataFetcher() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(DataFetchingEnvironment environment)</span> </span>&#123;</span><br><span class="line">        String argId = environment.getArgument(<span class="string">"id"</span>);</span><br><span class="line">        Object source = environment.getSource();</span><br><span class="line">        <span class="keyword">return</span> characterDataLoader.load(argId,source);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.dang8080.cn/2019/05/05/GraphQL-Scalars/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Humphrey Dan">
      <meta itemprop="description" content="write something,donot leave.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="äº‘é’é’å…®æ¬²é›¨">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/05/GraphQL-Scalars/" class="post-title-link" itemprop="url">GraphQL-Scalars</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-05-05 22:42:08 / Modified: 23:37:54" itemprop="dateCreated datePublished" datetime="2019-05-05T22:42:08+08:00">2019-05-05</time>
            </span>

          
            <span id="/2019/05/05/GraphQL-Scalars/" class="post-meta-item leancloud_visitors" data-flag-title="GraphQL-Scalars" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2019/05/05/GraphQL-Scalars/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/05/05/GraphQL-Scalars/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="graphql-ä¸­çš„å¸¸é‡"><a href="#graphql-ä¸­çš„å¸¸é‡" class="headerlink" title="graphql ä¸­çš„å¸¸é‡"></a>graphql ä¸­çš„å¸¸é‡</h2><h3 id="scalars"><a href="#scalars" class="headerlink" title="scalars"></a>scalars</h3><p>graphql ç±»å‹ç³»ç»Ÿçš„å¶å­èŠ‚ç‚¹è¢«ç§°ä¸º scalars.ä¸€æ—¦åˆ°è¾¾äº† scalar ç±»å‹åˆ™æ— æ³•åœ¨æ²¿ç€ç±»å‹ç»“æ„ç»§ç»­å‘ä¸‹äº†.scalar ç±»å‹æ˜¯æŒ‡ä¸å¯å†åˆ†å‰²çš„å€¼.<br>graphql è§„èŒƒæ˜ç¡®è¦æ±‚æ‰€æœ‰çš„è¯­è¨€å®ç°å¿…é¡»å…·æœ‰ä»¥ä¸‹ scalar ç±»å‹.</p>
<ul>
<li>String å³ <code>GraphQLString</code>- ä¸€ä¸ª UTF-8 å­—ç¬¦ä¸²åºåˆ—.</li>
<li>Boolean å³ <code>GraphQLBoolean</code>- true or false.</li>
<li>Int å³ <code>GraphQLInt</code>- æœ‰ç¬¦å·çš„ 32 æ•´å‹æ•°.</li>
<li>Float å³ <code>GraphQLFloat</code>- æœ‰ç¬¦å·çš„åŒç²¾åº¦æµ®ç‚¹æ•°.</li>
<li>ID å³ <code>GraphQLID</code>- ç±»ä¼¼äº String çš„å”¯ä¸€æ ‡è¯†ç¬¦.å®šä¹‰ä¸€ä¸ª ID æ ‡è¯†ç¬¦å³è¡¨ç¤ºè¯¥å±æ€§ä¸æ˜¯äººç±»å¯è¯†åˆ«çš„ç”¨é€”.<br>graphql-java ä¸º java ç³»ç»Ÿæ·»åŠ äº†ä»¥ä¸‹æœ‰ç”¨çš„ scalar ç±»å‹.</li>
<li>Long å³ <code>GraphQLLong</code>- åŸºäº java.lang.Long çš„ scalar.</li>
<li>Short å³ <code>GraphQLShort</code>- åŸºäº java.lang.Short çš„ scalar.</li>
<li>Byte å³ <code>GraphQLByte</code>- åŸºäº java.lang.Byte çš„ scalar.</li>
<li>BigDecimal å³ <code>GraphQLBigDicimal</code> åŸºäº java.math.BigDecimal çš„ scalar.</li>
<li>BigInteger å³ <code>GrapQLBigInteger</code> åŸºäº java.math.BigInteger çš„ scalar.</li>
</ul>
<p><code>graphql.Scalars</code>ç±»åŒ…å«äº†æä¾› scalar ç±»å‹çš„å•ä¾‹å®ä¾‹.</p>
<h3 id="è‡ªå®šä¹‰-scalars"><a href="#è‡ªå®šä¹‰-scalars" class="headerlink" title="è‡ªå®šä¹‰ scalars"></a>è‡ªå®šä¹‰ scalars</h3><p>ä½ å¯ä»¥å®ç°è‡ªå®šä¹‰ scalar.åœ¨è¿è¡Œæ—¶ä½ éœ€è¦å®Œæˆç±»å‹å¼ºåˆ¶è½¬æ¢,åé¢ä¼šè§£é‡Š.å‡è®¾æˆ‘ä»¬éœ€è¦ä¸€ä¸ª email çš„ scalar ç±»å‹.å®ƒæŠŠ email åœ°å€ä½œä¸ºè¾“å…¥è¾“å‡º.<br>æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå¦‚ä¸‹çš„ <code>graphql.schema.GraphQLScalarType</code> å•ä¾‹å®ä¾‹.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> GraphQLScalarType EMAIL = <span class="keyword">new</span> GraphQLScalarType(<span class="string">"email"</span>,<span class="string">"A cusom scalar that handles emails"</span>,<span class="keyword">new</span> Coercing() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">serialize</span><span class="params">(Object dataFetcehrResult)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> serilizeEmail(dataFetcherResult);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">parseValue</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> parseEmailFromVariable(input);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">parseLiteral</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> parseEmailFromAstLiteral(input);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="å¼ºåˆ¶ç±»å‹è½¬æ¢"><a href="#å¼ºåˆ¶ç±»å‹è½¬æ¢" class="headerlink" title="å¼ºåˆ¶ç±»å‹è½¬æ¢"></a>å¼ºåˆ¶ç±»å‹è½¬æ¢</h3><p>è‡ªå®šä¹‰ scalar å®ç°çš„çœŸæ­£ä½œç”¨ç‚¹åœ¨ <code>graphql.schema.Coercing</code>å®ç°.æœ‰ 3 ä¸ªå‡½æ•°éœ€è¦å®ç°</p>
<ul>
<li><code>parseValue</code>- æ¥æ”¶ä¸€ä¸ªè¾“å…¥å˜é‡,è½¬æ¢ä¸º java è¿è¡Œæ—¶å®ç°.</li>
<li><code>parseLiteral</code>-æ¥æ”¶ä¸€ä¸ª AST å­—ç¬¦ <code>graphql.language.Value</code> ä½œä¸ºè¾“å…¥,è½¬æ¢ä¸º java è¿è¡Œæ—¶å®ç°.</li>
<li><code>serialize</code>-æ¥æ”¶ä¸€ä¸ª Java å¯¹è±¡,æœ€ç»ˆè½¬ä¸º scalar è¾“å‡ºç±»å‹.<br>æ‰€ä»¥ä½ è‡ªå®šä¹‰çš„ scalar å®ç°éœ€è¦å¤„ç† 2 ä¸­ç±»å‹çš„è¾“å…¥(parseValue/parseLiteral)å’Œ 1 ä¸­è¾“å‡º(serialize).<br>å¦‚ä¸‹æŸ¥è¯¢,ä½¿ç”¨äº†å˜é‡,AST å­—ç¬¦ç„¶åè¾“å‡ºæˆ‘ä»¬éœ€è¦çš„ scalar ç±»å‹ email.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mutation Contact($mainContact: Email!) &#123;</span><br><span class="line">	makeContact(</span><br><span class="line">		mainContactEmail: $mainContact</span><br><span class="line">		backupContactEmial: &quot;backup@company.com&quot;</span><br><span class="line">	) &#123;</span><br><span class="line">		id</span><br><span class="line">		mainContactEmail</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çš„è‡ªå®šä¹‰ email scalar ç±»å‹å°†</p>
<ul>
<li>è°ƒç”¨ <code>parseValue</code> å°† <code>$mainContact</code>å˜é‡è½¬ä¸ºè¿è¡Œæ—¶å¯¹è±¡.</li>
<li>è°ƒç”¨ <code>parseLiteral</code> å°† AST <code>graphql.language.StringValue</code> â€œ<a href="mailto:backup@company.com">backup@company.com</a>â€œ è½¬æ¢ä¸ºè¿è¡Œæ—¶å¯¹è±¡.</li>
<li>è°ƒç”¨ <code>serialize</code> å°† mainContactEmial è¿è¡Œæ—¶å®ç°è½¬ä¸ºè¾“å‡ºå¯¹è±¡å½¢å¼.</li>
</ul>
<h3 id="è¾“å…¥è¾“å‡ºæ ¡éªŒ"><a href="#è¾“å…¥è¾“å‡ºæ ¡éªŒ" class="headerlink" title="è¾“å…¥è¾“å‡ºæ ¡éªŒ"></a>è¾“å…¥è¾“å‡ºæ ¡éªŒ</h3><p>ä¾‹å¦‚æˆ‘ä»¬çš„ email scalar å°†ä¼šæ ¡éªŒè¾“å…¥è¾“å‡ºæ˜¯å¦æ˜¯çœŸæ˜¯çš„ email åœ°å€.<br><code>graphql.schema.Coercing</code> åè®®å¦‚ä¸‹:</p>
<ul>
<li><code>serialize</code> åªå…è®¸æŠ›å‡º <code>graphql.schema.CoercingSerializeException</code>.è¿™è¡¨æ˜å€¼æ— æ³•è¢«åºåˆ—åŒ–ä¸ºåˆé€‚çš„å½¢å¼.å†³ä¸å…è®¸æŒ‡å®šå…¶ä»–è¿è¡Œæ—¶å¼‚å¸¸ä»¥å–å¾—æ™®é€šçš„ graphql æ ¡éªŒè¡Œä¸º.å¿…é¡»è¿”å›ä¸€ä¸ªé <code>null</code> å€¼.</li>
<li><code>parseValue</code> åªå…è®¸æŠ›å‡º <code>graphql.schema.CoercingParseValueException</code>.è¿™è¡¨æ˜å€¼æ— æ³•è¢«ä½œä¸ºè¾“å…¥è§£æä¸ºåˆé€‚çš„å½¢å¼..å†³ä¸å…è®¸æŒ‡å®šå…¶ä»–è¿è¡Œæ—¶å¼‚å¸¸ä»¥å–å¾—æ™®é€šçš„ graphql æ ¡éªŒè¡Œä¸º.å¿…é¡»è¿”å›ä¸€ä¸ªé <code>null</code> å€¼.</li>
<li><code>parseLiteral</code> åªå…è®¸æŠ›å‡º <code>graphql.schema.CoercingParseLiterialException</code>.è¿™è¡¨æ˜ AST å€¼æ— æ³•è¢«ä½œä¸ºè¾“å…¥è§£æä¸ºåˆé€‚çš„å½¢å¼..å†³ä¸å…è®¸æŒ‡å®šå…¶ä»–è¿è¡Œæ—¶å¼‚å¸¸ä»¥å–å¾—æ™®é€šçš„ graphql æ ¡éªŒè¡Œä¸º.<br>æœ‰çš„äººå°è¯•ä¾èµ–è¿è¡Œæ—¶å¼‚å¸¸æ ¡éªŒä»¥æœŸè·å–æ™®é€šçš„ graphql é”™è¯¯.è¿™æ˜¯è¡Œä¸é€šçš„.å¿…é¡»éµç…§ <code>Coercing</code> æ–¹æ³•åè®®ä½¿ graphql-java å¼•æ“æŒ‰ç…§ grapqhl çš„ scalar ç±»å‹è§„èŒƒè¿è¡Œ.</li>
</ul>
<h3 id="ç¤ºä¾‹å®ç°"><a href="#ç¤ºä¾‹å®ç°" class="headerlink" title="ç¤ºä¾‹å®ç°"></a>ç¤ºä¾‹å®ç°</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ email scalar ç±»å‹å®ç°,å±•ç¤ºäº†å¦‚ä½•é€šè¿‡ç»§æ‰¿ <code>Coercing</code> å®ç°ä¸€ä¸ª scalar.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">EmailScalar</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> GraphQLScalarType EMAIL = <span class="keyword">new</span> GraphQLScalarType(<span class="string">"email"</span>,<span class="string">"A custom scalar that handles emails"</span>,<span class="keyword">new</span> Coercing() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Object <span class="title">serialize</span><span class="params">(Object dataFetcherResult)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> serializeEmail(dataFetcherResult);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Object <span class="title">parseValue</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> parseEmailFromVariable(input);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Object <span class="title">parseLiterial</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> parseEmialFromAstLiterial(input);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">looksLikeAnEmailAddress</span><span class="params">(String possibleEmailValue)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Pattern.matches(<span class="string">"[A-Za-z0-9]@[.*]"</span>,possibleEmailValue);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Object <span class="title">serialzeEmail</span><span class="params">(Object dataFetcherResult)</span> </span>&#123;</span><br><span class="line">        String possibleEmailValue = String.valueOf(dataFetcherResult);</span><br><span class="line">        <span class="keyword">if</span> (looksLikeAnEmailAddress(possibleEmailValue)) &#123;</span><br><span class="line">            <span class="keyword">return</span> possibleEmailValue;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> CoercingSerializeException(<span class="string">"Unable to serialize"</span> + possibleEmailValue + <span class="string">" as an email address"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Object <span class="title">parseEmailFromVariable</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (input <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">            String possibleEmailValue = input.toString();</span><br><span class="line">            <span class="keyword">if</span> (looksLikeAnEmailAddress(possibleEmailValue)) &#123;</span><br><span class="line">                <span class="keyword">return</span> possibleEmailValue;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> CoercingParseValueException(<span class="string">"Unable to parse variable value "</span> + input + <span class="string">" as an email address"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Object <span class="title">parseEmailFromAstLiterial</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (input <span class="keyword">instanceof</span> StringValue) &#123;</span><br><span class="line">            String possibleEmailValue = ((StringValue)input).getValue();</span><br><span class="line">            <span class="keyword">if</span> (looksLikeAnEmailAddress(possibleEmailValue)) &#123;</span><br><span class="line">                <span class="keyword">return</span> possibleEmailValue;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> CoercingParseLiterialException(<span class="string">"Unable to parse variable value "</span> + input + <span class="string">" as an email address"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.dang8080.cn/2019/05/05/GraphQL-Data-mapping/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Humphrey Dan">
      <meta itemprop="description" content="write something,donot leave.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="äº‘é’é’å…®æ¬²é›¨">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/05/GraphQL-Data-mapping/" class="post-title-link" itemprop="url">GraphQL-Data mapping</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-05-05 13:02:31 / Modified: 14:04:12" itemprop="dateCreated datePublished" datetime="2019-05-05T13:02:31+08:00">2019-05-05</time>
            </span>

          
            <span id="/2019/05/05/GraphQL-Data-mapping/" class="post-meta-item leancloud_visitors" data-flag-title="GraphQL-Data mapping" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2019/05/05/GraphQL-Data-mapping/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/05/05/GraphQL-Data-mapping/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Mapping-data"><a href="#Mapping-data" class="headerlink" title="Mapping data"></a>Mapping data</h2><h3 id="graphql-æ˜¯å¦‚ä½•æŠŠå¯¹è±¡æ•°æ®åŒ¹é…åˆ°ç±»å‹çš„"><a href="#graphql-æ˜¯å¦‚ä½•æŠŠå¯¹è±¡æ•°æ®åŒ¹é…åˆ°ç±»å‹çš„" class="headerlink" title="graphql æ˜¯å¦‚ä½•æŠŠå¯¹è±¡æ•°æ®åŒ¹é…åˆ°ç±»å‹çš„"></a>graphql æ˜¯å¦‚ä½•æŠŠå¯¹è±¡æ•°æ®åŒ¹é…åˆ°ç±»å‹çš„</h3><p>graphql å†…éƒ¨å…¨éƒ¨æ˜¯å…³äºå£°æ˜ç±»å‹ schema,ç„¶ååœ¨è¿è¡ŒåŒ¹é…åˆ°æ•°æ®.<br>ä½œä¸ºç±»å‹ schema çš„è®¾è®¡è€…,ä½ åº”è¯¥åœ¨å¤„ç†è¿™äº›å…ƒç´ .</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">type Query &#123;</span><br><span class="line">	products(match: String): [Product] # a list of products</span><br><span class="line">&#125;</span><br><span class="line">type Product &#123;</span><br><span class="line">	id: ID</span><br><span class="line">	name: String</span><br><span class="line">	description: String</span><br><span class="line">	cost: Float</span><br><span class="line">	tax: Float</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åå¯ä»¥æ‰§è¡ŒæŸ¥è¯¢</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">query ProductQuery &#123;</span><br><span class="line">	products(match: &quot;Paper*&quot;) &#123;</span><br><span class="line">		id</span><br><span class="line">		name</span><br><span class="line">		cost</span><br><span class="line">		tax</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹äº <code>Query.products</code>å±æ€§æœ‰ä¸€ä¸ªç»‘å®šçš„ <code>DataFetcher</code>è´Ÿè´£æŸ¥æ‰¾åŒ¹é…è¾“å…¥å‚æ•°çš„ product s åˆ—è¡¨.<br>å‡è®¾æˆ‘ä»¬æœ‰ 3 ä¸ªä¸‹æ¸¸æœåŠ¡.ä¸€ä¸ªè·å–äº§å“ä¿¡æ¯,ä¸€ä¸ªè·å–äº§å“ä»·æ ¼ä¿¡æ¯,ä¸€ä¸ªè®¡ç®—æŸ¥æ–°ç¨æ”¶ä¿¡æ¯.<br>graphql-java ä½¿ç”¨è¿™äº›å¯¹è±¡è¿è¡Œ data fetcher,è·å–ä¿¡æ¯ç„¶åå°†å…¶åŒ¹é…åˆ° schema æŒ‡å®šçš„ç±»å‹ä¸­.<br>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è·å–åˆ°è¿™ 3 ä¸ªæºçš„ä¿¡æ¯,ç„¶åæŠŠå®ƒä»¬ä½œä¸ºä¸€ä¸ª unified ç±»å‹å±•ç¤º.<br>æˆ‘ä»¬å¯ä»¥å¯¹ cost å’Œ tax éœ€è¦è®¡ç®—çš„å±æ€§æŒ‡å®š data fetcher,ä½†è¿™éœ€è¦æ›´å¤šçš„ç»´æŠ¤ç²¾åŠ›,å¯èƒ½å¯¼è‡´ N+1 æ€§èƒ½é—®é¢˜.<br>æˆ‘ä»¬æœ€å¥½åœ¨ <code>Query.products</code> data fetcher ä¸­è·å–æ‰€æœ‰çš„ä¿¡æ¯,åŒæ—¶åˆ›å»ºä¸€ä¸ª unified æ•°æ®è§†å›¾.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DataFetcher produtctsDataFetcher = <span class="keyword">new</span> DataFetcher() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(DataFetchingEnvironment env)</span> </span>&#123;</span><br><span class="line">        String matchArg = env.getArgument(<span class="string">"match"</span>);</span><br><span class="line">        List&lt;ProductInfo&gt; productInfos = getMatchingProducts(matchArg);</span><br><span class="line">        List&lt;ProductCostInfo&gt; productConstInfo = getProdutConsts(productInfo);</span><br><span class="line">        List&lt;ProductTaxInfo&gt; productTaxInfo = getProductTax(productInfo);</span><br><span class="line">        <span class="keyword">return</span> mapDataTogether(productInfo,productCostInfo,productTaxInfo);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æœ‰ 3 ä¸ªç±»å‹çš„ä¿¡æ¯éœ€è¦è¢«æ•´åˆä¸ºä¸€ä¸ªä»¥ä¾¿ graphql æŸ¥è¯¢å¯ä»¥è®¿é—® id,name,cost,tax å±æ€§.<br>æœ‰ 2 ä¸­æ–¹æ³•å¯ä»¥åˆ›å»ºè¿™ä¸ªæ˜ å°„.ä¸€ä¸ªæ˜¯ä½¿ç”¨ç±»å‹ä¸å®‰å…¨çš„ <code>List&lt;Map&gt;</code> ç»“æ„,å¦ä¸€ä¸ªæ˜¯ä½¿ç”¨ç±»å‹å®‰å…¨çš„ <code>List&lt;ProductDTO&gt;</code>å°è£…è¿™äº›æ•°æ®.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> List&lt;Map&gt; <span class="title">mapDataTogetherViaMap</span><span class="params">(List&lt;ProductInfo&gt; productInfo,List&lt;ProductCostInfo&gt; productCostInfo,List&lt;ProductTaxInfo&gt; productTaxInfo)</span> </span>&#123;</span><br><span class="line">    List&lt;Map&gt; unifiedView = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; productInfo.size();i++) &#123;</span><br><span class="line">        ProductInfo info = productInfo.get(i);</span><br><span class="line">        ProductCostInfo cost = productCostInfo.get(i);</span><br><span class="line">        ProductTaxInfo tax = productTaxInfo.get(i);</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Object&gt; objectMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        objectMap.put(<span class="string">"id"</span>,info.getId());</span><br><span class="line">        objectMap.put(<span class="string">"name"</span>,info.getName());</span><br><span class="line">        objectMap.put(<span class="string">"descriptioin"</span>,info.getDescription());</span><br><span class="line">        objectMap.put(<span class="string">"cost"</span>,cost.getCost());</span><br><span class="line">        objectMap.put(<span class="string">"tax"</span>,tax.getTax());</span><br><span class="line"></span><br><span class="line">        unifiedView.add(objectMap);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> unifiedView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProductDTO</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String description;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Float cost;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Float tax;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ProductDTO</span><span class="params">(String id, String name, String description, Float cost, Float tax)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.description = description;</span><br><span class="line">        <span class="keyword">this</span>.cost = cost;</span><br><span class="line">        <span class="keyword">this</span>.tax = tax;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> description;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Float <span class="title">getCost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cost;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Float <span class="title">getTax</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> tax;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> List&lt;ProductDTO&gt; <span class="title">mapDataTogetherViaDTO</span><span class="params">(List&lt;ProductInfo&gt; productInfo, List&lt;ProductCostInfo&gt; productCostInfo, List&lt;ProductTaxInfo&gt; productTaxInfo)</span> </span>&#123;</span><br><span class="line">    List&lt;ProductDTO&gt; unifiedView = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; productInfo.size(); i++) &#123;</span><br><span class="line">        ProductInfo info = productInfo.get(i);</span><br><span class="line">        ProductCostInfo cost = productCostInfo.get(i);</span><br><span class="line">        ProductTaxInfo tax = productTaxInfo.get(i);</span><br><span class="line"></span><br><span class="line">        ProductDTO productDTO = <span class="keyword">new</span> ProductDTO(</span><br><span class="line">                info.getId(),</span><br><span class="line">                info.getName(),</span><br><span class="line">                info.getDescription(),</span><br><span class="line">                cost.getCost(),</span><br><span class="line">                tax.getTax()</span><br><span class="line">        );</span><br><span class="line">        unifiedView.add(productDTO);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> unifiedView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>graphql å¼•æ“ç°åœ¨å¯ä»¥ä½¿ç”¨ object åˆ—è¡¨ç„¶åè¿è¡ŒæŸ¥è¯¢è·å– id,name,cost,tax å±æ€§.<br>graphql-java é»˜è®¤çš„ data fetcher <code>graphql.schema.PropertyDataFetcher</code> åŒæ—¶æ”¯æŒ map å’Œ POJO.<br>å¯¹äºåˆ—è¡¨çš„æ¯ä¸€ä¸ªå¯¹è±¡éƒ½ä¼šé€šè¿‡ id å±æ€§,æˆ–ä½¿ç”¨ name åœ¨ map é‡ŒæŸ¥æ‰¾,æˆ–é€šè¿‡ getId() æ–¹æ³•è·å–,ç„¶åè¿”å›ç»™ graphql response.å¯¹äºæŸ¥è¯¢ä¸­çš„æ¯ä¸ªç±»å‹éƒ½ä¼šæ‰§è¡Œè¿™æ ·çš„æ“ä½œ.<br>é€šè¿‡åœ¨é«˜çº§ data fetcher ä¸­åˆ›å»ºä¸€ä¸ª unified view,ä½ å°±å¯ä»¥åœ¨è¿è¡Œæ—¶æ•°æ®å’Œ graphql schema ä¹‹é—´å»ºç«‹ä¸€ä¸ªæ˜ å°„.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.dang8080.cn/2019/05/04/GraphQL-Execution/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Humphrey Dan">
      <meta itemprop="description" content="write something,donot leave.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="äº‘é’é’å…®æ¬²é›¨">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/04/GraphQL-Execution/" class="post-title-link" itemprop="url">GraphQL-Execution</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-05-04 21:25:19" itemprop="dateCreated datePublished" datetime="2019-05-04T21:25:19+08:00">2019-05-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-05-05 10:03:06" itemprop="dateModified" datetime="2019-05-05T10:03:06+08:00">2019-05-05</time>
              </span>

          
            <span id="/2019/05/04/GraphQL-Execution/" class="post-meta-item leancloud_visitors" data-flag-title="GraphQL-Execution" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2019/05/04/GraphQL-Execution/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/05/04/GraphQL-Execution/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Execution"><a href="#Execution" class="headerlink" title="Execution"></a>Execution</h2><h3 id="Queries"><a href="#Queries" class="headerlink" title="Queries"></a>Queries</h3><p>å¯¹ schema æ‰§è¡Œ query,ä½¿ç”¨åˆé€‚çš„å‚æ•°æ„å»ºä¸€ä¸ªæ–°çš„ GraphQL å¯¹è±¡,ç„¶åè°ƒç”¨<code>execute()</code>.<br>query çš„ç»“æœæ˜¯åŒ…å«æŸ¥è¯¢æ•°æ®æˆ–è€…ï¼ˆå¹¶ä¸”ï¼‰ä¸€ç³»åˆ—é”™è¯¯çš„<code>ExecutionResult</code> å¯¹è±¡.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GraphQLSchema schema = GraphQLSchema.newSchema().query(queryType).build();</span><br><span class="line">GraphQL graphQl = GraphQL.newGraphQL(schema).build();</span><br><span class="line">ExecutionInput executionInput = ExecutionInput.newExecutionInput().query(<span class="string">"query &#123; hero &#123; name &#125;&#125;"</span>);</span><br><span class="line">ExectionResult executionResult = graphQl.execute(executionInput);</span><br><span class="line">Object data = executionResult.getData();</span><br><span class="line">List&lt;GraphQLError&gt; errors = executionResult.getErrors();</span><br></pre></td></tr></table></figure>

<p>æ›´å¤šå¤æ‚çš„æŸ¥è¯¢ç¤ºä¾‹è¯·å‚è€ƒ<a href="https://github.com/graphql-java/graphql-java/blob/master/src/test/groovy/graphql/StarWarsQueryTest.groovy" target="_blank" rel="noopener">StarWars query tests</a>;</p>
<h3 id="Data-Fetchers"><a href="#Data-Fetchers" class="headerlink" title="Data Fetchers"></a>Data Fetchers</h3><p>æ¯ä¸ª graphql å±æ€§ç±»å‹éƒ½æœ‰ä¸€ä¸ª <code>graphql.schema.DataFetcher</code> ä¸ä¹‹å…³è”.å…¶ä»– graphql å®ç°é€šå¸¸æŠŠè¿™ä¸ªç±»å‹æˆä¸º <code>resolvers</code>.<br>é€šå¸¸å¯ä»¥ä½¿ç”¨<code>graphql.schema.PropertyDataFetcher</code>æ¥æ£€æŸ¥ æä¾›å±æ€§å€¼çš„ Java POJO å¯¹è±¡.å¦‚æœæŸä¸ªå±æ€§æœªæŒ‡å®š data fetcher,é»˜è®¤ä¼šä½¿ç”¨è¿™ä¸ª.<br>ç„¶è€Œä½ å¯èƒ½éœ€è¦ä½¿ç”¨è‡ªå®šä¹‰çš„ data fetcehr è·å–ä½ çš„é¡¶çº§åŸŸå¯¹è±¡.å¯èƒ½æ¶‰åŠåˆ°æ•°æ®åº“è°ƒç”¨æˆ–é€šè¿‡ HTTP è¯·æ±‚å…¶ä»–ç³»ç»Ÿ.<br><code>graphql-java</code>ä¸å…³å¿ƒä½ æ˜¯å¦‚ä½•è·å–ä½ çš„åŸŸå¯¹è±¡,è¿™æ˜¯ä½ éœ€è¦å…³å¿ƒçš„åœ°æ–¹.åŒæ—¶ä¹Ÿä¸å…³å¿ƒç”¨æˆ·è®¿é—®æ•°æ®æˆæƒ.è¿™äº›éƒ½åº”è¯¥æ”¾åˆ°ä½ è‡ªå·±çš„é€»è¾‘å¤„ç†å±‚.<br>data fetcher ç¤ºä¾‹å¦‚ä¸‹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DataFetcher userDataFetcher = <span class="keyword">new</span> DataFetcher() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(DataFetchingEnvironment environment)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> fetchUserFromDatabase(environment.getArgument(<span class="string">"userId"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æ¯ä¸ª <code>DataFetcher</code>éƒ½ä¼šä¼ é€’ä¸€ä¸ª <code>graphql.schema.DataFetchingEnvironment</code> å¯¹è±¡(åŒ…å«äº†å°†è¦è·å–çš„å±æ€§,è·å–è¯¥å±æ€§æ‰€éœ€æä¾›çš„å‚æ•°å’Œå…¶ä»–ä¿¡æ¯å¦‚å±æ€§çš„çˆ¶å¯¹è±¡,query æ ¹å¯¹è±¡æˆ– query ä¸Šä¸‹æ–‡å¯¹è±¡).<br>ä¸Šä¾‹ä¸­,<code>execution</code>å°†ä¼šåœ¨ data fetcher è¿”å›ç»“æœåæ‰ç»§ç»­æ‰§è¡Œ.å¯ä»¥é€šè¿‡è¿”å›<code>CompletionStage</code> å¯¹è±¡ä½¿ <code>DataFetcher</code> å¼‚æ­¥æ‰§è¡Œ,è¯¦æƒ…è¯·ç»§ç»­é˜…è¯».</p>
<h3 id="å½“è·å–æ•°æ®æ—¶å‘ç”Ÿå¼‚å¸¸"><a href="#å½“è·å–æ•°æ®æ—¶å‘ç”Ÿå¼‚å¸¸" class="headerlink" title="å½“è·å–æ•°æ®æ—¶å‘ç”Ÿå¼‚å¸¸"></a>å½“è·å–æ•°æ®æ—¶å‘ç”Ÿå¼‚å¸¸</h3><p>å¦‚æœåœ¨ data fetcher è°ƒç”¨ä¸­å‘ç”Ÿå¼‚å¸¸,é‚£ä¹ˆé»˜è®¤æ‰§è¡Œç­–ç•¥å°†ç”Ÿæˆ<code>graphql.ExceptionWhileDataFetching</code> é”™è¯¯,ç„¶åæ·»åŠ åˆ°ç»“æœä¸­çš„é”™è¯¯é›†ä¸­.åˆ‡è®° graphql å…è®¸å¸¦é”™è¯¯çš„éƒ¨åˆ†ç»“æœ.<br>ä¸‹é¢æ˜¯æ ‡å‡†çš„è¡Œä¸º.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleDataFetcherExceptionHandler</span> <span class="keyword">implements</span> <span class="title">DataFetcherExceptionhandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(SimpleDataFetcherExceptionHandler.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(DataFetcherExceptionHandlerParameters handlerParameters)</span> </span>&#123;</span><br><span class="line">        Throwable exception = handlerParameters.getException();</span><br><span class="line">        SourceLocation sourceLocation = handlerParameters.getField().getSourceLocation();</span><br><span class="line">        ExecutionPath path = handlerParameters.getPath();</span><br><span class="line"></span><br><span class="line">        ExceptionWhileDataFetching error = <span class="keyword">new</span> ExceptionWhileDataFetching(path,exception,sourceLocation);</span><br><span class="line">        handlerParameters.getExecutionContext().addError(error);</span><br><span class="line">        log.warn(error.getMessage(),exception);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½ æŠ›å‡ºçš„æ˜¯<code>GraphqlError</code>,é‚£ä¹ˆå®ƒä¼šä» exception ä¸­è½¬æ¢ message å’Œè‡ªå®šä¹‰æ‰©å±•å±æ€§åˆ° <code>ExceptionWhileDataFetching</code>å¯¹è±¡.æ­¤å¤„å…è®¸ä½ å‘è°ƒç”¨è€…è¿”å›è‡ªå®šä¹‰çš„å±æ€§åˆ° graphql error.<br>ä¾‹å¦‚æƒ³è±¡ä½ çš„ data fetcher å°†æŠ›å‡ºè¿™ä¸ªå¼‚å¸¸.<code>foo</code> å’Œ <code>fizz</code> å±æ€§å°†è¢«æ·»åŠ åˆ°è¿”å›çš„ graphql error ä¸­.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomRuntimeException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> <span class="keyword">implements</span> <span class="title">GrapQLError</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title">getExtension</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; customAttributes = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line">        customAttributes.put(<span class="string">"foo"</span>,<span class="string">"bar"</span>);</span><br><span class="line">        cutomAttributes.put(<span class="string">"fizz"</span>,<span class="string">"whizz"</span>);</span><br><span class="line">        <span class="keyword">return</span> customAttributes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;SourceLocation&gt; <span class="title">getLocation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ErrorType <span class="title">getErrorType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ErrorType.DataFetchingException;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½ å¯ä»¥é€šè¿‡åˆ›å»ºè‡ªå·±çš„ <code>graphql.execution.DataFetcherExceptionHandler</code>å¼‚å¸¸å¤„ç†ä»£ç æ”¹å˜æ­¤é»˜è®¤è¡Œä¸º,ç»™å‡ºä½ è‡ªå·±çš„æ‰§è¡Œç­–ç•¥.<br>ä¾‹å¦‚ä¸Šé¢çš„ä»£ç è®°å½•äº†åŸºç¡€å¼‚å¸¸å’Œå †æ ˆè·Ÿè¸ª.æœ‰çš„äººå¯èƒ½ä¸å–œæ¬¢åœ¨è¾“å‡ºé”™è¯¯åˆ—è¡¨ä¸­çœ‹åˆ°è¿™äº›.æ‰€ä»¥ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªæœºåˆ¶æ”¹å˜è¿™ä¸ªè¡Œä¸º.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DataFetcherExceptionHandler handler = <span class="keyword">new</span> DataFetcherExceptionHandler() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(DataFetcherExceptionHandlerParameters handlerParameters)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">ExecutionStrategy executionStrategy = <span class="keyword">new</span> AsyncExecutionStrategy(handler);</span><br></pre></td></tr></table></figure>

<h3 id="è¿”å›å€¼å’Œé”™è¯¯"><a href="#è¿”å›å€¼å’Œé”™è¯¯" class="headerlink" title="è¿”å›å€¼å’Œé”™è¯¯"></a>è¿”å›å€¼å’Œé”™è¯¯</h3><p>åœ¨<code>DataFetcher</code>å®ç°ä¸­é€šè¿‡ç›´æ¥æˆ–è€…ä½¿ç”¨ <code>CompletableFuture</code> å®ä¾‹åŒ…è£…å¼‚æ­¥æ‰§è¡Œè¿”å› <code>graphql.execution.DataFetcherResult</code> æ¥å®ç°åŒæ—¶è¿”å›æ•°æ®å’Œå¤šä¸ªé”™è¯¯.å½“ä½ çš„<code>DataFetcher</code> éœ€è¦ä»å¤šä¸ªæ•°æ®æºæˆ–å…¶ä»– GraphQL èµ„æºè·å–æ•°æ®æ—¶ç‰¹åˆ«æœ‰ç”¨.<br>åœ¨è¿™ä¸ª ğŸŒ° ä¸­,<code>DataFetcher</code> ä»å¦ä¸€ä¸ª GraphQL èµ„æºä¸­è·å– user åŒæ—¶è¿”å›æ•°æ®å’Œé”™è¯¯.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DataFetcher userDataFetcher = <span class="keyword">new</span> DataFetcher() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(DataFetchingEnvironment environment)</span> </span>&#123;</span><br><span class="line">        Map response = fetchUserFromRemoteGraphQLResource(environment.getArgument(<span class="string">"userID"</span>));</span><br><span class="line">        List&lt;GralhQLError&gt; errors = response.get(<span class="string">"errors)</span></span><br><span class="line"><span class="string">                                            .stream()</span></span><br><span class="line"><span class="string">                                            .map(MyMapGraphQLError::new)</span></span><br><span class="line"><span class="string">                                            .collect(Collections.toList());</span></span><br><span class="line"><span class="string">        return new DataFetcherResult(response.get("</span>data<span class="string">"),errors);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="å°†ç»“æœåºåˆ—åŒ–ä¸º-JSON"><a href="#å°†ç»“æœåºåˆ—åŒ–ä¸º-JSON" class="headerlink" title="å°†ç»“æœåºåˆ—åŒ–ä¸º JSON"></a>å°†ç»“æœåºåˆ—åŒ–ä¸º JSON</h3><p>è°ƒç”¨ graphql æœ€å¸¸è§çš„æ–¹æ³•æ˜¯é€šè¿‡ HTTP,è¿”å› JSON å“åº”.æ‰€ä»¥ä½ éœ€è¦å°† <code>graphql.ExecutionResult</code> è½¬ä¸º JSON.<br>æœ€å¸¸ç”¨çš„å®ç°æ˜¯ä½¿ç”¨ Jackson æˆ– GSON è¿™æ ·çš„ JSON åºåˆ—åŒ–åº“.ç„¶è€Œå®ƒä»¬è§£ææ•°æ®çš„æ–¹å¼æœ‰å®ƒä»¬è‡ªå·±çš„ä¸€å¥—æ–¹å¼.ä¾‹å¦‚ <code>nulls</code>å¯¹ graphql ç»“æœæ˜¯å¾ˆé‡è¦çš„,æ‰€ä»¥ä½ å¿…é¡»åœ¨è®¾ç½® json mapper æ—¶åŒ…å«å®ƒ.<br>ä¸ºäº†ä¿è¯ä½ è·å–çš„ JSON ç»“æœ 100% ç¬¦åˆ graphql çš„éœ€æ±‚,ä½ åº”è¯¥å¯¹ç»“æœè°ƒç”¨<code>toSpecification</code>,ç„¶åå°†å…¶ä½œä¸º JSON è¿”å›.<br>è¿™å°†ä¼šç¡®ä¿è¿”å›çš„ç»“æœç¬¦åˆ<a href="http://facebook.github.io/graphql/#sec-Response" target="_blank" rel="noopener">è§„èŒƒ</a>.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ExecutionResult executionResult = graphQL.execute(executinInput);</span><br><span class="line">Map&lt;String,Object&gt; toSpecificationResult = executionResult.toSpecification();</span><br><span class="line">sendAsJson(toSpecificationResult);</span><br></pre></td></tr></table></figure>

<h3 id="Mutations"><a href="#Mutations" class="headerlink" title="Mutations"></a>Mutations</h3><p><a href="http://graphql.org/learn/queries/#mutations" target="_blank" rel="noopener">åœ¨è¿™å„¿</a>å­¦ä¹  mutations.<br>æœ¬è´¨ä¸Šä½ éœ€è¦å®šä¹‰ä¸€ä¸ªæ¥æ”¶å‚æ•°ä½œä¸ºè¾“å…¥çš„ <code>GraphQLObjectType</code> .è¿™äº›å‚æ•°ä½ å¯ä»¥é€šè¿‡ data fetcher è°ƒç”¨ä¿®æ”¹ä½ çš„æ•°æ®å­˜å‚¨.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mutation CreateReviewForEpisode($ep: Episode!, $review: ReviewInput!) &#123;</span><br><span class="line">	createReview(episode: $ep, review: $review) &#123;</span><br><span class="line">		stars</span><br><span class="line">		commentary</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰§è¡Œ mutation æ“ä½œä¸­éœ€è¦ä¼ é€’å‚æ•°,æœ¬ä¾‹ä¸­æ˜¯ <code>$ep</code> å’Œ <code>$review</code> å‚æ•°.<br>ä½ å¯ä»¥åƒè¿™æ ·åˆ›å»ºç±»å‹å¤„ç† mutation æ“ä½œ.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">GraphQLInputObjectType episodeType = newInputObject()</span><br><span class="line">                .name(<span class="string">"Episode"</span>)</span><br><span class="line">                .field(newInputObjectField()</span><br><span class="line">                        .name(<span class="string">"episodeNumber"</span>)</span><br><span class="line">                        .type(Scalars.GraphQLInt))</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">GraphQLInputObjectType reviewInputType = newInputObject()</span><br><span class="line">        .name(<span class="string">"ReviewInput"</span>)</span><br><span class="line">        .field(newInputObjectField()</span><br><span class="line">                .name(<span class="string">"stars"</span>)</span><br><span class="line">                .type(Scalars.GraphQLString)</span><br><span class="line">                .name(<span class="string">"commentary"</span>)</span><br><span class="line">                .type(Scalars.GraphQLString))</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line">GraphQLObjectType reviewType = newObject()</span><br><span class="line">        .name(<span class="string">"Review"</span>)</span><br><span class="line">        .field(newFieldDefinition()</span><br><span class="line">                .name(<span class="string">"stars"</span>)</span><br><span class="line">                .type(GraphQLString))</span><br><span class="line">        .field(newFieldDefinition()</span><br><span class="line">                .name(<span class="string">"commentary"</span>)</span><br><span class="line">                .type(GraphQLString))</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line">GraphQLObjectType createReviewForEpisodeMutation = newObject()</span><br><span class="line">        .name(<span class="string">"CreateReviewForEpisodeMutation"</span>)</span><br><span class="line">        .field(newFieldDefinition()</span><br><span class="line">                .name(<span class="string">"createReview"</span>)</span><br><span class="line">                .type(reviewType)</span><br><span class="line">                .argument(newArgument()</span><br><span class="line">                        .name(<span class="string">"episode"</span>)</span><br><span class="line">                        .type(episodeType)</span><br><span class="line">                )</span><br><span class="line">                .argument(newArgument()</span><br><span class="line">                        .name(<span class="string">"review"</span>)</span><br><span class="line">                        .type(reviewInputType)</span><br><span class="line">                )</span><br><span class="line">        )</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line">GraphQLCodeRegistry codeRegistry = newCodeRegistry()</span><br><span class="line">        .dataFetcher(</span><br><span class="line">                coordinates(<span class="string">"CreateReviewForEpisodeMutation"</span>, <span class="string">"createReview"</span>),</span><br><span class="line">                mutationDataFetcher()</span><br><span class="line">        )</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GraphQLSchema schema = GraphQLSchema.newSchema()</span><br><span class="line">        .query(queryType)</span><br><span class="line">        .mutation(createReviewForEpisodeMutation)</span><br><span class="line">        .codeRegistry(codeRegistry)</span><br><span class="line">        .build();</span><br></pre></td></tr></table></figure>

<p>è¯·æ³¨æ„è¾“å…¥å‚æ•°ç±»å‹æ˜¯ <code>GraphQLInputObjectType</code>.è¿™æ˜¯å¾ˆé‡è¦çš„.è¾“å…¥ç±»å‹åªèƒ½æ˜¯è¿™ç§ç±»å‹,ç»ä¸èƒ½ä½¿ç”¨è¾“å‡ºç±»å‹å¦‚ <code>GraphQLObjectType</code>.æ ‡é‡ç±»å‹æ—¢å¯ä»¥æ˜¯è¾“å…¥ç±»å‹ä¹Ÿå¯ä»¥æ˜¯è¾“å‡ºç±»å‹.<br>è¿™ä¸ª data fetcher æ‰§è¡Œ mutation,è¿”å›ä¸€äº›æœ‰æ„ä¹‰çš„è¾“å‡ºå€¼.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> DataFetcher <span class="title">mutationDataFetcher</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> DataFetcher() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Review <span class="title">get</span><span class="params">(DataFetchingEnvironment environment)</span> </span>&#123;</span><br><span class="line">            Map&lt;String,Object&gt; episodeInputMap = environemnt.getArugment(<span class="string">"episode"</span>);</span><br><span class="line">            Map&lt;String,Object&gt; reviewInputMap = environment.getArugment(<span class="string">"review"</span>);</span><br><span class="line"></span><br><span class="line">            EpisodeInput episodeInput = EpisodeInput.fromMap(episodeInputMap);</span><br><span class="line">            ReviewInput reviewInput = ReviewInput.fromMap(reviewInputMap);</span><br><span class="line">            Review updatedReview = reviewStore().update(episodeInput, reviewInput);</span><br><span class="line">            <span class="keyword">return</span> updatedReview;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¼‚æ­¥æ‰§è¡Œ"><a href="#å¼‚æ­¥æ‰§è¡Œ" class="headerlink" title="å¼‚æ­¥æ‰§è¡Œ"></a>å¼‚æ­¥æ‰§è¡Œ</h3><p>graphql-java æ‰§è¡ŒæŸ¥è¯¢æ—¶å¯ä»¥å®Œå…¨æ”¯æŒå¼‚æ­¥æ‰§è¡Œ.ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ <code>executeAsync()</code> è·å– <code>CompletableFuture</code>çš„ç»“æœ.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GraphQL graphql = buildSchema();</span><br><span class="line">ExecutionInput executionInput = ExecutionInput.newExecutionInput().query(<span class="string">"query &#123; hero &#123; name &#125;&#125;"</span>).build();</span><br><span class="line">CompletableFuture&lt;ExecutionResult&gt; promise = graphql.executeAsync(executionInput);</span><br><span class="line">promise.thenAccept(executinoResult -&gt; &#123;</span><br><span class="line">    encodeResultToJsonAndSendResponse(executionResult);</span><br><span class="line">&#125;);</span><br><span class="line">promise.join();</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ <code>CompletableFuture</code> å¯ä»¥åœ¨æ‰§è¡Œå®Œæˆæ—¶ç»„åˆ action å’Œ function.æœ€ç»ˆè°ƒç”¨ <code>join()</code> ç­‰å¾…æ‰§è¡Œå®Œæˆ.<br>graphql-java ä½¿ç”¨å¼‚æ­¥æ‰§è¡Œçš„åŸç†æ˜¯é€šè¿‡ join è°ƒç”¨é€šè¿‡æ–¹æ³•<code>execute()</code>.æ‰€ä»¥ä¸‹é¢çš„ä»£ç æ•ˆæœæ˜¯ä¸€æ ·çš„.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ExecutionResult executionResult = graphql.execute(executionInput);</span><br><span class="line">CompletableFuture&lt;ExecutionResult&gt; promise = graphql.executeAsync(executionInput);</span><br><span class="line">ExecutionResult executionResult = promise.join();</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ <code>graphql.schema.DataFetcher</code> è¿”å›çš„æ˜¯ <code>CompletableFuture&lt;T&gt;</code> å¯¹è±¡,é‚£ä¹ˆè¿™ä¸ªç»“æœå°†è¢«ç»„åˆè¿›æ•´ä¸ªå¼‚æ­¥æŸ¥è¯¢æ‰§è¡Œä¸­.è¿™æ„å‘³ç€ä½ å¯ä»¥å¹¶è¡Œå‘èµ·å¤šä¸ªå±æ€§æŸ¥è¯¢è¯·æ±‚.ä½ ä½¿ç”¨çš„çº¿ç¨‹æ± ç­–ç•¥å–å†³äºä½ çš„ data fetcher ä»£ç .<br>ä¸‹é¢çš„ä»£ç é‡‡ç”¨äº†æ ‡å‡†çš„ <code>java.util.concurrent.ForkJoinPool.commonPool()</code> çº¿ç¨‹æ‰§è¡Œå™¨åœ¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹æä¾›æ•°æ®.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DataFetcher userDataFetcher = <span class="keyword">new</span> DataFetcher() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(DataFetchingEnvironment environment)</span> </span>&#123;</span><br><span class="line">        CompletableFuture&lt;User&gt; userPromise = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">return</span> fetchUserViaHttp(environment.getArgument(<span class="string">"userId"</span>));</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> userPromise;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç ç”¨ Java8 Lambdas å¯ä»¥ç®€ç•¥ä¸º:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFetcher userDataFetcher = environment -&gt; CompletableFuture.supplyAsync(() -&gt; fetchUserViaHttp(environment.getArgument(<span class="string">"userId"</span>));</span><br></pre></td></tr></table></figure>

<p>graphql-java å¼•æ“ç¡®ä¿æ‰€æœ‰çš„ <code>CompletableFuture</code> å¯¹è±¡éµç…§ graphql è§„èŒƒç»„åˆåœ¨ä¸€èµ·æä¾›æ‰§è¡Œç»“æœ.<br>è¿™æ˜¯ graphql-java åˆ›å»ºå¼‚æ­¥ data fetcher çš„å¿«æ·æ–¹å¼.ä½¿ç”¨ <code>graphql.schema.AsyncDataFetcher.async(DataFetcher&lt;T&gt;)</code> åŒ…è£…ä¸€ä¸ª DataFetcher.å¯ä»¥ä½¿ç”¨é™æ€å¯¼å…¥åˆ›å»ºæ›´æ˜“è¯»çš„ä»£ç .</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFetcher userDataFetcher = async(environment -&gt; fetchUserViaHttp(environment.getArgument(<span class="string">"userId"</span>)));</span><br></pre></td></tr></table></figure>

<h3 id="æ‰§è¡Œç­–ç•¥"><a href="#æ‰§è¡Œç­–ç•¥" class="headerlink" title="æ‰§è¡Œç­–ç•¥"></a>æ‰§è¡Œç­–ç•¥</h3><p>ç»§æ‰¿ <code>graphql.execution.ExecutionStrategy</code> çš„ç±»å¯ä»¥ç”¨äºè¿è¡Œä¸€ä¸ªæŸ¥è¯¢æˆ–ä¿®æ”¹. graphql-java æä¾›äº†å¤§é‡ä¸åŒçš„ç­–ç•¥,å¦‚æœä½ éå¸¸è¿«åˆ‡,ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„.<br>å½“ä½ åˆ›å»º Graphql å¯¹è±¡æ—¶å¯ä»¥ç¡®å®šæ‰§è¡Œç­–ç•¥.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GraphQL.newGraphQL(schema)</span><br><span class="line">        .queryExecutionStrategy(<span class="keyword">new</span> AsyncExecutionStrategy())</span><br><span class="line">        .mutationExecutionStrategy(<span class="keyword">new</span> AsyncSerialExecutionStrategy())</span><br><span class="line">        .build();</span><br></pre></td></tr></table></figure>

<p>å®é™…ä¸Šä¸Šé¢çš„ä»£ç å’Œé»˜è®¤è®¾ç½®ä¸€è‡´,å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯ä¸€ä¸ªæ˜æ™ºçš„ç­–ç•¥é€‰æ‹©.</p>
<h3 id="å¼‚æ­¥æ‰§è¡Œç­–ç•¥"><a href="#å¼‚æ­¥æ‰§è¡Œç­–ç•¥" class="headerlink" title="å¼‚æ­¥æ‰§è¡Œç­–ç•¥"></a>å¼‚æ­¥æ‰§è¡Œç­–ç•¥</h3><p>é»˜è®¤çš„æŸ¥è¯¢æ‰§è¡Œç­–ç•¥æ˜¯ <code>graphql.execution.AsyncExecutionStrategy</code>,ä¼šæŠŠæ¯ä¸€ä¸ªå±æ€§ä½œä¸º <code>CompletableFuture</code> å¯¹è±¡åˆ†å‘,å¹¶ä¸”ä¸å…³å¿ƒå“ªä¸ªæœ€å…ˆå®Œæˆ.æ­¤ç­–ç•¥æ˜¯æ€§èƒ½æœ€ä½³çš„æ‰§è¡Œç­–ç•¥.<br>data fetchers æœ¬èº«ä¼šè¿”å› <code>CompletionStage</code> å€¼,è¿™å°†å¯¼è‡´å®Œå…¨å¼‚æ­¥çš„è¡Œä¸º.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">query &#123;</span><br><span class="line">	hero &#123;</span><br><span class="line">		enemies &#123;</span><br><span class="line">			name</span><br><span class="line">		&#125;</span><br><span class="line">		friends &#123;</span><br><span class="line">			name</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>AsyncExecutionStrategy</code> è‡ªç”±åˆ†å‘ <i>enemies</i> å±æ€§å’Œ <i>friends</i>å±æ€§.<i>enemies</i> å±æ€§ä¸å¿…ç­‰å¾… <i>friends</i>å±æ€§è¿”å›.è¿™æ˜¯éå¸¸ä½æ•ˆçš„.<br>æ— è®ºå¦‚ä½•,æœ€ç»ˆä¼šå°†ç»“æœæŒ‰é¡ºåºæ’åˆ—.æŸ¥è¯¢ç»“æœå°†éµç…§ graphql è§„èŒƒ,è¿”å›ç»“æœå¯¹åº” query å±æ€§é¡ºåº.åªæœ‰ data fetcher çš„æ‰§è¡Œæ˜¯éšæœºé¡ºåº.</p>
<h3 id="å¼‚æ­¥åºåˆ—åŒ–æ‰§è¡Œç­–"><a href="#å¼‚æ­¥åºåˆ—åŒ–æ‰§è¡Œç­–" class="headerlink" title="å¼‚æ­¥åºåˆ—åŒ–æ‰§è¡Œç­–"></a>å¼‚æ­¥åºåˆ—åŒ–æ‰§è¡Œç­–</h3><p>graphql è§„èŒƒè¦æ±‚ mutation å¿…é¡»æŒ‰ç…§ query å±æ€§çš„é¡ºåºåºåˆ—åŒ–æ‰§è¡Œ.<br>æ‰€ä»¥ mutation é»˜è®¤ä½¿ç”¨ <code>graphql.execution.AsyncSerialExecutionStrategy</code> ç­–ç•¥.å®ƒä¼šä¿è¯åœ¨æ‰§è¡Œä¸‹ä¸€ä¸ªå’Œåé¢å‰å½“å‰çš„æ¯ä¸ªå±æ€§æ‰§è¡Œå®Œæ¯•.ä¹Ÿå¯ä»¥åœ¨ mutation data fetcher ä¸­è¿”å› <code>CompletionStage</code> å¯¹è±¡,å¹¶ä¸”ä¼šæŒ‰é¡ºåºåœ¨ä¸‹ä¸€ä¸ª mutation å±æ€§ data fetcher è¢«åˆ†å‘ä¹‹å‰æ‰§è¡Œå®Œæ¯•.</p>
<h3 id="è®¢é˜…æ‰§è¡Œç­–ç•¥"><a href="#è®¢é˜…æ‰§è¡Œç­–ç•¥" class="headerlink" title="è®¢é˜…æ‰§è¡Œç­–ç•¥"></a>è®¢é˜…æ‰§è¡Œç­–ç•¥</h3><p>graphql å…è®¸å¯¹ graphql data åˆ›å»ºæœ‰çŠ¶æ€çš„è®¢é˜….å¯ä»¥ä½¿ç”¨ <code>SubscriptionExecutionStrategy</code>å®ç°,åŒæ—¶æ”¯æŒ reactive-stream API.<br><a href="https://www.graphql-java.com/documentation/v12/subscriptions" target="_blank" rel="noopener">æŸ¥çœ‹</a>äº†è§£æ›´å¤šåŸºäº graphql æœåŠ¡çš„è®¢é˜…æ”¯æŒ.</p>
<h3 id="æŸ¥è¯¢ç¼“å­˜"><a href="#æŸ¥è¯¢ç¼“å­˜" class="headerlink" title="æŸ¥è¯¢ç¼“å­˜"></a>æŸ¥è¯¢ç¼“å­˜</h3><p>åœ¨ graphql-java å¼•æ“æ‰§è¡ŒæŸ¥è¯¢ä¹‹å‰å¿…é¡»è¢«è§£æå’Œæ£€éªŒ,å¹¶ä¸”è¿™ä¸ªå¤„ç†è¿‡ç¨‹å¯èƒ½æœ‰äº›è€—æ—¶.<br>ä¸ºäº†é¿å…é‡å¤è§£æ/æ ¡éªŒ<code>GraphQL.Builder</code>å…è®¸<code>PreparsedDocumentProvider</code>å®ä¾‹å¤ç”¨<code>Document</code>å®ä¾‹.<br>æ³¨æ„ âš ï¸,è¿™åªç¼“å­˜è§£æçš„ <code>Document</code>,ä¸ç¼“å­˜æŸ¥è¯¢ç»“æœ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Cache&lt;String,PreparsedDocumentEntry&gt; cache = Caffeine.newBuilder().maximumSize(<span class="number">10_000</span>).build();</span><br><span class="line">GraphQL graphql = GraphQL.newGraphQL(StarWarsSchema.starWarsSchema)</span><br><span class="line">        .preparsedDocumentProvider(cache::get)</span><br><span class="line">        .build();</span><br></pre></td></tr></table></figure>

<ul>
<li>è¿™ä¸ªç¼“å­˜å®ä¾‹åº”è¯¥æ˜¯çº¿ç¨‹å®‰å…¨å…±äº«çš„.</li>
<li><code>PreparsedDocumentProvider</code> æ˜¯ä¸€ä¸ªåªæœ‰ä¸€ä¸ª get æ–¹æ³•çš„å‡½æ•°æ¥å£,æˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸€ä¸ªæ–¹æ³•å¼•ç”¨åˆ°é‡Œé¢ä»¥åŒ¹é… builder çš„ç­¾å.</li>
</ul>
<p>ä¸ºäº†å®ç°é«˜ç¼“å­˜è¦†ç›–ç‡,æ¨èå±æ€§å‚æ•°é€šè¿‡å˜é‡ä¼ é€’è€Œä¸æ˜¯ç›´æ¥åœ¨ query ä¸­å®šä¹‰.<br>ä¸‹é¢çš„æŸ¥è¯¢:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">query HelloTo &#123;</span><br><span class="line">	sayHello(to: &quot;ME&quot;) &#123;</span><br><span class="line">		greeting</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åº”è¯¥è¿™æ ·å†™:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">query HelloTo($to: String!) &#123;</span><br><span class="line">	sayHello(to: $to) &#123;</span><br><span class="line">		greeting</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å’Œå˜é‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;to&quot;: &quot;Me&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨å°±å¯ä»¥ä¸ç®¡æä¾›çš„å˜é‡æ˜¯ä»€ä¹ˆè€Œé‡ç”¨æŸ¥è¯¢.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.dang8080.cn/2019/04/27/GraphQL-DataFetcher/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Humphrey Dan">
      <meta itemprop="description" content="write something,donot leave.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="äº‘é’é’å…®æ¬²é›¨">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/04/27/GraphQL-DataFetcher/" class="post-title-link" itemprop="url">GraphQL-DataFetcher</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-04-27 23:07:22 / Modified: 23:13:13" itemprop="dateCreated datePublished" datetime="2019-04-27T23:07:22+08:00">2019-04-27</time>
            </span>

          
            <span id="/2019/04/27/GraphQL-DataFetcher/" class="post-meta-item leancloud_visitors" data-flag-title="GraphQL-DataFetcher" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2019/04/27/GraphQL-DataFetcher/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/04/27/GraphQL-DataFetcher/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="è·å–æ•°æ®"><a href="#è·å–æ•°æ®" class="headerlink" title="è·å–æ•°æ®"></a>è·å–æ•°æ®</h2><h3 id="graphql-å¦‚ä½•è·å–æ•°æ®"><a href="#graphql-å¦‚ä½•è·å–æ•°æ®" class="headerlink" title="graphql å¦‚ä½•è·å–æ•°æ®"></a>graphql å¦‚ä½•è·å–æ•°æ®</h3><p>graphql ä¸­çš„æ¯ä¸ªå±æ€§éƒ½å…³è”äº†ä¸€ä¸ª graphql.schema.DataFetcher.<br>ä¸€äº›å±æ€§ä¼šä½¿ç”¨ä¸“ç”¨çš„ data fetcher ä»æ•°æ®åº“è·å–è¯¥å±æ€§çš„ç›¸å…³ä¿¡æ¯.è€Œå¤§å¤šæ•°ç®€å•çš„ä½¿ç”¨å±æ€§åå’Œ Plain Old Java Object(POJO)æ¨¡å¼ ä»å†…å­˜ä¸­è·å–æ•°æ®.<br><code>åœ¨å…¶ä»– graphql å®ç°ä¸­ï¼ŒData fetcher è¢«ç§°ä¸º resolver</code><br>ç°åœ¨å£°æ˜ä¸€ä¸ªç±»å‹å®šä¹‰:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">type Query &#123;</span><br><span class="line">	products(match: String): [Product] # a list of products</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type Product &#123;</span><br><span class="line">	id: ID</span><br><span class="line">	name: String</span><br><span class="line">	description: String</span><br><span class="line">	cost: Float</span><br><span class="line">	tax: Float</span><br><span class="line">	launchDate(dateFormat: String &#x3D; &quot;dd,MM,yyyy&quot;): String</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://blog.dang8080.cn/2019/04/12/%E7%A7%BB%E5%8A%A8%E4%BC%98%E5%85%88%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BD%91%E9%A1%B5%E8%AE%BE%E8%AE%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Humphrey Dan">
      <meta itemprop="description" content="write something,donot leave.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="äº‘é’é’å…®æ¬²é›¨">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/04/12/%E7%A7%BB%E5%8A%A8%E4%BC%98%E5%85%88%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BD%91%E9%A1%B5%E8%AE%BE%E8%AE%A1/" class="post-title-link" itemprop="url">ç§»åŠ¨ä¼˜å…ˆçš„å“åº”å¼ç½‘é¡µè®¾è®¡</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-04-12 13:20:33 / Modified: 14:25:40" itemprop="dateCreated datePublished" datetime="2019-04-12T13:20:33+08:00">2019-04-12</time>
            </span>

          
            <span id="/2019/04/12/%E7%A7%BB%E5%8A%A8%E4%BC%98%E5%85%88%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BD%91%E9%A1%B5%E8%AE%BE%E8%AE%A1/" class="post-meta-item leancloud_visitors" data-flag-title="ç§»åŠ¨ä¼˜å…ˆçš„å“åº”å¼ç½‘é¡µè®¾è®¡" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2019/04/12/%E7%A7%BB%E5%8A%A8%E4%BC%98%E5%85%88%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BD%91%E9%A1%B5%E8%AE%BE%E8%AE%A1/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/04/12/%E7%A7%BB%E5%8A%A8%E4%BC%98%E5%85%88%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BD%91%E9%A1%B5%E8%AE%BE%E8%AE%A1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a href="https://www.html5rocks.com/en/mobile/responsivedesign/" target="_blank" rel="noopener">åŸæ–‡</a></p>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æœ¬æ–‡å°†æ¢ç´¢å¦‚ä½•åˆ›å»ºç§»åŠ¨ä¼˜å…ˆçš„ç½‘é¡µè®¾è®¡ä½“éªŒã€‚</p>
<ul>
<li>ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦åˆ›å»ºç§»åŠ¨ä¼˜å…ˆï¼Œå“åº”å¼ï¼Œé€‚åº”å¼ç½‘é¡µè®¾è®¡ä½“éªŒ?</li>
<li>å¦‚ä½•é’ˆå¯¹é€‚åº”å¼ç«™ç‚¹ç»„ç»‡ HTML ç»“æ„ä»¥ä¾¿ä¼˜åŒ–æ€§èƒ½ï¼Œä¼˜å…ˆè€ƒè™‘çµæ´»æ€§?</li>
<li>å¦‚ä½•ä¹¦å†™ä¼˜å…ˆå®šä¹‰å…±äº«æ ·å¼ã€é’ˆå¯¹å¤§å±å’Œåª’ä½“æŸ¥è¯¢æ„å»ºã€ä½¿ç”¨ç›¸å¯¹å•ä½çš„ CSS?</li>
<li>å¦‚ä½•ç¼–å†™ä¸å¼•äººæ³¨ç›®çš„ Javascript æ¥æœ‰æ¡ä»¶åœ°åŠ è½½å†…å®¹ç‰‡æ®µï¼Œåˆ©ç”¨è§¦æ‘¸äº‹ä»¶å’Œåœ°ç†å®šä½</li>
<li>æˆ‘ä»¬å¯ä»¥åšäº›ä»€ä¹ˆæ¥è¿›ä¸€æ­¥å¢å¼ºæˆ‘ä»¬çš„é€‚åº”æ€§ä½“éªŒ</li>
</ul>
<h2 id="é€‚åº”æ€§çš„å¿…è¦æ€§"><a href="#é€‚åº”æ€§çš„å¿…è¦æ€§" class="headerlink" title="é€‚åº”æ€§çš„å¿…è¦æ€§"></a>é€‚åº”æ€§çš„å¿…è¦æ€§</h2><p>éšç€ç½‘ç»œç¯å¢ƒè¶Šæ¥è¶Šå¤æ‚ï¼Œä¸ºè¶Šæ¥è¶Šå¤šçš„ç¯å¢ƒæä¾›å¯é çš„ç½‘ç»œä½“éªŒå˜å¾—æä¸ºé‡è¦.å¹¸è¿çš„æ˜¯ï¼Œå“åº”å¼ web è®¾è®¡ç»™ web å¼€å‘è€…æä¾›äº†ä¸€äº›å¯ä»¥åŒ¹é…ä»»æ„å¤§å°å±å¹•çš„å·¥å…·æ¥ç»„ç»‡å¸ƒå±€.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Humphrey Dan</p>
  <div class="site-description" itemprop="description">write something,donot leave.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">47</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/shuttlespace" title="GitHub â†’ https://github.com/shuttlespace" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:dang8080@qq.com" title="E-Mail â†’ mailto:dang8080@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
  <div class="beian"><a href="http://www.beian.miit.gov.cn" rel="noopener" target="_blank">é™•ICPå¤‡19000066å·-1 </a>
  </div>

<div class="copyright">
  
  &copy; 2017 â€“ 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Humphrey Dan</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : true,
      appId      : 'z4355CFJqLqEOkacAfCt07Tw-gzGzoHsz',
      appKey     : 'MMeHfXwH0V14BmSIRAX2mxcj',
      placeholder: "è¡¨æ‰¬ğŸ‘ä¸€ä¸‹å§",
      avatar     : 'wavatar',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
